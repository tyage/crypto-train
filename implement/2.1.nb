(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11646,        302]
NotebookOptionsPosition[     11099,        280]
NotebookOutlinePosition[     11437,        295]
CellTagsIndexPosition[     11394,        292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Get", "[", "\"\<./lib/ExEuclid\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<./lib/ModBinary\>\"", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"Get", "[", "\"\<./lib/CRT.m\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PowerModCRT", "[", 
     RowBox[{"p_", ",", "q_", ",", "a_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "ecd", ",", "akp", ",", "akq"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"p", "*", "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ecd", "=", 
        RowBox[{"ExEuclid", "[", 
         RowBox[{"p", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"akp", "=", 
        RowBox[{"ModBinary", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"k", ",", 
            RowBox[{"p", "-", "1"}]}], "]"}], ",", "a", ",", "p"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"akq", "=", 
        RowBox[{"ModBinary", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"k", ",", 
            RowBox[{"q", "-", "1"}]}], "]"}], ",", "a", ",", "q"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"CRT", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", ",", "q"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"akp", ",", "akq"}], "}"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
  "p1", "=", 
   "10613812301896775148829942637102985462412287794185387738467245762759618509\
602736605195641054166216571968217361061547640892557039740729186347713124789244\
883"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "q1", "=", 
   "11573035663327195853844238843542869333876114938989475499001708305357650732\
178608301848288199284899914248138795286406545785601968971231714755377248265509\
893"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "a1", "=", 
   "55171369910051437990412690780976918864004594400468057936995626399169935459\
645309293638273839011433220903844032978223080651001963165983148138903866465070\
349687717707483416960247609257698976748740151772071505763335844637258758436116\
165847460549578238068993246164273928592104593882489289102848385889827348866771\
"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "k1", "=", 
    "4790803212446670864050828211396166041485128160179973794784420229758404202\
954831447373512192239347898923647055028741276845024428026245342488520041070952\
254994809206872823194946734913741339098486811764228852716852146572363264396293\
076829064688036543959733544619328089043828142255591055214582450508641853068439\
0"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p2", "=", 
   "11853085763133505990286201269363921131755361282207771806454216823906463045\
956110404018518118871988561332197770015175458025096566875663947404231597048649\
687"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "q2", "=", 
   "13241479879786700069537673013402283713461303895018638725043715728333351182\
535991791698730454905679569343041660910401104499998964541968688709360528771269\
943"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "a2", "=", 
   "82731728725194908289223617666367457469528377629992344486892227999473808545\
734393601481638213883755082805006377065439788661243573340349538848236261335923\
042025459102737381949187014999261611684851439601167620664754455469880526500359\
543926950153918830779325957499251936408013440092257831969264506172196199532825\
"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "k2", "=", 
    "1510611613367997820279099488215310586749095034892255437441918572391793012\
087474799180275286680672639888302145292263587723560597448181975565700735725395\
153114171741349438840714148046233931768319143104364158663585331414086205295606\
796094054970175524650667906953003014085035728199079159048404723275421397090622\
4"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p3", "=", 
   "95997244720774591709384092953513489967332868455933807236782870157978693765\
829946987175571590631124804878040576672023051127066389695431443647091934730483\
47"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "q3", "=", 
   "12159036449739250060609630988836226873200838844190023998478881025520411437\
687569870906890579561081670068532247424765460564721749130863519839443424280486\
653"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "n3", "=", 
   "11672339976344370570856845969548913546627640956374532374042571362591075486\
777858433057430427430796048925073072977695486588029274234069501543209520503281\
464975665678480630441186655378062782205022188868596292680602927750498387055511\
201758708624963140024150305756483638313773310561815698080034211880490455721259\
1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "a3", "=", 
   "87671424421652388950642689643896199006445185897064638074058896168088599903\
264970862279686844170611506580163120454794848393134265598192406101533528611357\
631402234248276942302630353561038435876081389801027719173622195125722971702016\
017585000053477422925129871008047640445660779625633162226643547573746743342095\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "k3", "=", 
    "8775639933869342577235886357222170288853027947321531508309154201012623195\
924064615409080926736780704644331846291899483997539515433714539205927346214190\
589329251925224986213568741208948106741169087981097957408494921032742856680538\
73689318129510131320907810069764941637729701978307429594182978513273171579104"\
}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop", "=", "1000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"time", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PowerModCRT", "[", 
           RowBox[{"p1", ",", "q1", ",", "a1", ",", "k1"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PowerModCRT", "[", 
   RowBox[{"p1", ",", "q1", ",", "a1", ",", "k1"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PowerModCRT", "[", 
           RowBox[{"p2", ",", "q2", ",", "a2", ",", "k2"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PowerModCRT", "[", 
   RowBox[{"p2", ",", "q2", ",", "a2", ",", "k2"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PowerModCRT", "[", 
           RowBox[{"p3", ",", "q3", ",", "a3", ",", "k3"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PowerModCRT", "[", 
  RowBox[{"p3", ",", "q3", ",", "a3", ",", "k3"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.67230726412082*^9, 3.672307290160779*^9}, {
  3.672307342486452*^9, 3.672307355741268*^9}, {3.672307419092195*^9, 
  3.672307469739004*^9}}],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{{3.672307344901801*^9, 3.672307357891068*^9}, 
   3.672307454710598*^9}],

Cell[BoxData["0.0013998`"], "Print",
 CellChangeTimes->{{3.672307344915576*^9, 3.672307351824829*^9}, 
   3.672307411177775*^9, 3.6723074547231817`*^9}],

Cell[BoxData[\
"10270125080405967434883911675161113020999769226574641899518103353938961788524\
767724341863348533299642363167378783611495953002080660921512198683772760658239\
275715160158598630109040615480727974412959439638832821986153789938490347136794\
8705996892479986580149251500405384465638905697732997100463826309075315116459"]\
, "Output",
 CellChangeTimes->{{3.672307344901801*^9, 3.672307357891068*^9}, 
   3.672307454741021*^9}],

Cell[BoxData["0.0012998`"], "Print",
 CellChangeTimes->{{3.672307344915576*^9, 3.672307351824829*^9}, 
   3.672307411177775*^9, 3.672307454755721*^9}],

Cell[BoxData[\
"99759903977601044034322950563057134881632913550881493197317517677731043799192\
385636400244018532112750305100050104076260929096164057113859671031475264069076\
144245318354124609222139035066989292671456548964078674169863263835961093731548\
280460317872385016806962641694498949520059594337762621003685246628847567366"],\
 "Output",
 CellChangeTimes->{{3.672307344901801*^9, 3.672307357891068*^9}, 
   3.6723074547728443`*^9}],

Cell[BoxData["0.0013998`"], "Print",
 CellChangeTimes->{{3.672307344915576*^9, 3.672307351824829*^9}, 
   3.672307411177775*^9, 3.672307454812063*^9}],

Cell[BoxData[\
"10627678607711486871223320617929353377845897004874371880326792406293813262892\
848349327676324094011646774494642483838736451489775122480038023070612522782537\
838646354471894986774984109094140335801456781108263803563680492140769257624311\
9326710335428634011109485398973473098038354258135642514229425902739051430448"]\
, "Output",
 CellChangeTimes->{{3.672307344901801*^9, 3.672307357891068*^9}, 
   3.672307454812913*^9}]
}, Open  ]]
},
WindowSize->{828, 904},
WindowMargins->{{896, Automatic}, {Automatic, 37}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8593, 212, 2409, "Input"],
Cell[9176, 236, 122, 2, 32, "Output"],
Cell[9301, 240, 152, 2, 23, "Print"],
Cell[9456, 244, 438, 7, 121, "Output"],
Cell[9897, 253, 150, 2, 23, "Print"],
Cell[10050, 257, 439, 7, 121, "Output"],
Cell[10492, 266, 150, 2, 23, "Print"],
Cell[10645, 270, 438, 7, 121, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
