(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15442,        365]
NotebookOptionsPosition[     14674,        334]
NotebookOutlinePosition[     15012,        349]
CellTagsIndexPosition[     14969,        346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Get", "[", "\"\<./lib/ExEuclid\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<./lib/ModBinary\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<./lib/CRT.m\>\"", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.67230560327738*^9, 3.6723056580660477`*^9}, {
  3.6723057538387423`*^9, 3.6723057963505173`*^9}, {3.672306236696707*^9, 
  3.672306239575555*^9}, {3.6723063610027103`*^9, 3.672306368202281*^9}, {
  3.672306408985936*^9, 3.6723064194108677`*^9}, {3.672306587597125*^9, 
  3.672306596083645*^9}, {3.6723070053601418`*^9, 3.672307009910367*^9}}],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{
  3.672306241250494*^9, 3.67230627327918*^9, {3.67230636193435*^9, 
   3.672306368543153*^9}, {3.672306410226574*^9, 3.672306419916601*^9}, {
   3.672306591834255*^9, 3.672306596705755*^9}, 3.67230689169495*^9, 
   3.672307010786653*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.672305820436681*^9, 3.67230582115456*^9}}],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {
    RowBox[{"\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"PowerModCRT", "[", 
         RowBox[{"p_", ",", "q_", ",", "a_", ",", "k_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n", ",", "ecd", ",", "akp", ",", "akq"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"p", "*", "q"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ecd", "=", 
            RowBox[{"ExEuclid", "[", 
             RowBox[{"p", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"akp", "=", 
            RowBox[{"ModBinary", "[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", 
                RowBox[{"p", "-", "1"}]}], "]"}], ",", "a", ",", "p"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"akq", "=", 
            RowBox[{"ModBinary", "[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"k", ",", 
                RowBox[{"q", "-", "1"}]}], "]"}], ",", "a", ",", "q"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"CRT", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"akp", ",", "akq"}], "}"}]}], "]"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{
       "p1", "=", 
        "106138123018967751488299426371029854624122877941853877384672457627596\
185096027366051956410541662165719682173610615476408925570397407291863477131247\
89244883"}], ";"}], "\n", 
      RowBox[{
       RowBox[{
       "q1", "=", 
        "115730356633271958538442388435428693338761149389894754990017083053576\
507321786083018482881992848999142481387952864065457856019689712317147553772482\
65509893"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "a1", "=", 
        "551713699100514379904126907809769188640045944004680579369956263991699\
354596453092936382738390114332209038440329782230806510019631659831481389038664\
650703496877177074834169602476092576989767487401517720715057633358446372587584\
361161658474605495782380689932461642739285921045938824892891028483858898273488\
66771"}], ";"}], "\n", 
      RowBox[{
       RowBox[{
       "k1", "=", 
        "479080321244667086405082821139616604148512816017997379478442022975840\
420295483144737351219223934789892364705502874127684502442802624534248852004107\
095225499480920687282319494673491374133909848681176422885271685214657236326439\
629307682906468803654395973354461932808904382814225559105521458245050864185306\
84390"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "p2", "=", 
        "118530857631335059902862012693639211317553612822077718064542168239064\
630459561104040185181188719885613321977700151754580250965668756639474042315970\
48649687"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "q2", "=", 
        "132414798797867000695376730134022837134613038950186387250437157283333\
511825359917916987304549056795693430416609104011044999989645419686887093605287\
71269943"}], ";"}], "\n", 
      RowBox[{
       RowBox[{
       "a2", "=", 
        "827317287251949082892236176663674574695283776299923444868922279994738\
085457343936014816382138837550828050063770654397886612435733403495388482362613\
359230420254591027373819491870149992616116848514396011676206647544554698805265\
003595439269501539188307793259574992519364080134400922578319692645061721961995\
32825"}], ";"}], "\n", 
      RowBox[{
       RowBox[{
       "k2", "=", 
        "151061161336799782027909948821531058674909503489225543744191857239179\
301208747479918027528668067263988830214529226358772356059744818197556570073572\
539515311417174134943884071414804623393176831914310436415866358533141408620529\
560679609405497017552465066790695300301408503572819907915904840472327542139709\
06224"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "p3", "=", 
        "959972447207745917093840929535134899673328684559338072367828701579786\
937658299469871755715906311248048780405766720230511270663896954314436470919347\
3048347"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "q3", "=", 
        "121590364497392500606096309888362268732008388441900239984788810255204\
114376875698709068905795610816700685322474247654605647217491308635198394434242\
80486653"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "n3", "=", 
        "116723399763443705708568459695489135466276409563745323740425713625910\
754867778584330574304274307960489250730729776954865880292742340695015432095205\
032814649756656784806304411866553780627822050221888685962926806029277504983870\
555112017587086249631400241503057564836383137733105618156980800342118804904557\
212591"}], ";"}], "\n", 
      RowBox[{
       RowBox[{
       "a3", "=", 
        "876714244216523889506426896438961990064451858970646380740588961680885\
999032649708622796868441706115065801631204547948483931342655981924061015335286\
113576314022342482769423026303535610384358760813898010277191736221951257229717\
020160175850000534774229251298710080476404456607796256331622266435475737467433\
42095"}], ";"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "k3", "=", 
        "877563993386934257723588635722217028885302794732153150830915420101262\
319592406461540908092673678070464433184629189948399753951543371453920592734621\
419058932925192522498621356874120894810674116908798109795740849492103274285668\
053873689318129510131320907810069764941637729701978307429594182978513273171579\
104"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loop", "=", "100"}], ";"}], "\n", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Timing", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", "0"}], ",", 
              RowBox[{"i", "<", "loop"}], ",", 
              RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"PowerModCRT", "[", 
                RowBox[{"p1", ",", "q1", ",", "a1", ",", "k1"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
      RowBox[{
       RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Timing", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", "0"}], ",", 
              RowBox[{"i", "<", "loop"}], ",", 
              RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"PowerModCRT", "[", 
                RowBox[{"p2", ",", "q2", ",", "a2", ",", "k2"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
      RowBox[{
       RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Timing", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", "0"}], ",", 
              RowBox[{"i", "<", 
               RowBox[{"loop", "+", "2000"}]}], ",", 
              RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"PowerModCRT", "[", 
                RowBox[{"p3", ",", "q3", ",", "a3", ",", "k3"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
      RowBox[{
       RowBox[{"Print", "[", "time", "]"}], ";"}]}]}]},
   {"\[Placeholder]"},
   {"\[Placeholder]"},
   {"\[Placeholder]"}
  }]], "Input",
 CellChangeTimes->{{3.671862046087967*^9, 3.671862078319963*^9}, {
   3.671862237009542*^9, 3.671862353330172*^9}, {3.671862409766535*^9, 
   3.671862454031291*^9}, {3.6718625007785273`*^9, 3.671862538718364*^9}, {
   3.671862601543936*^9, 3.67186262767775*^9}, {3.671862668616598*^9, 
   3.6718628633131113`*^9}, {3.671862909826111*^9, 3.6718629405665913`*^9}, {
   3.671863060994432*^9, 3.67186309213417*^9}, {3.6718631324528513`*^9, 
   3.6718631824734583`*^9}, {3.6718632479033012`*^9, 3.671863248878524*^9}, {
   3.671863366862091*^9, 3.671863434368333*^9}, {3.6718635160852737`*^9, 
   3.671863526642702*^9}, {3.671863578612618*^9, 3.671863699695498*^9}, {
   3.671863810986182*^9, 3.671864063200452*^9}, 3.6718681453293133`*^9, 
   3.672291623683687*^9, {3.672291695245129*^9, 3.6722917161591177`*^9}, {
   3.672291944362282*^9, 3.6722919780417423`*^9}, {3.672293174195263*^9, 
   3.672293177984404*^9}, {3.672293261434123*^9, 3.67229326943125*^9}, {
   3.67229330680999*^9, 3.6722933155422697`*^9}, {3.6722934588864737`*^9, 
   3.6722934795548077`*^9}, {3.672293536653088*^9, 3.672293587346086*^9}, {
   3.672293746810913*^9, 3.6722939248518476`*^9}, {3.672305600498262*^9, 
   3.6723056255431347`*^9}, {3.672305718634652*^9, 3.672305720113138*^9}, {
   3.6723058101184397`*^9, 3.6723058104446373`*^9}, 3.672306050284412*^9, {
   3.672306244047971*^9, 3.672306262982092*^9}, 3.672306909553238*^9, {
   3.672307191906588*^9, 3.67230721891436*^9}}],

Cell[CellGroupData[{

Cell[BoxData["0.00013998`"], "Print",
 CellChangeTimes->{{3.672293861708519*^9, 3.6722939173992968`*^9}, {
   3.672293972736559*^9, 3.6722939805512247`*^9}, {3.6723042278312798`*^9, 
   3.672304234771667*^9}, 3.672305641531578*^9, {3.672305701970292*^9, 
   3.672305720670506*^9}, 3.672305755942212*^9, {3.672305801121355*^9, 
   3.6723058151451817`*^9}, {3.672306253101234*^9, 3.672306263669848*^9}, 
   3.672306424283381*^9, {3.672307013118313*^9, 3.672307016512473*^9}, {
   3.672307188788537*^9, 3.6723072198560257`*^9}}],

Cell[BoxData["0.00012998`"], "Print",
 CellChangeTimes->{{3.672293861708519*^9, 3.6722939173992968`*^9}, {
   3.672293972736559*^9, 3.6722939805512247`*^9}, {3.6723042278312798`*^9, 
   3.672304234771667*^9}, 3.672305641531578*^9, {3.672305701970292*^9, 
   3.672305720670506*^9}, 3.672305755942212*^9, {3.672305801121355*^9, 
   3.6723058151451817`*^9}, {3.672306253101234*^9, 3.672306263669848*^9}, 
   3.672306424283381*^9, {3.672307013118313*^9, 3.672307016512473*^9}, {
   3.672307188788537*^9, 3.672307219856653*^9}}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.671862787821665*^9, 3.6718629411744947`*^9, {3.6718631739057503`*^9, 
   3.671863186543227*^9}, 3.671863434859201*^9, {3.671863618815948*^9, 
   3.671863636557551*^9}, {3.671863680564636*^9, 3.67186369386592*^9}, 
   3.671863744117017*^9, {3.671863806920247*^9, 3.671863842952221*^9}, {
   3.671863942936144*^9, 3.671863979708177*^9}, {3.671864015967807*^9, 
   3.671864045545726*^9}, 3.6722932703314047`*^9, 3.672293316364964*^9, 
   3.672293482165036*^9, {3.6722935399102488`*^9, 3.672293588347835*^9}, {
   3.6722937523034286`*^9, 3.6722938029867573`*^9}, {3.6722938461352453`*^9, 
   3.672293918714581*^9}, {3.6722939728057823`*^9, 3.672293980602455*^9}, {
   3.672304227901745*^9, 3.672304234793199*^9}, 3.672305641631606*^9, {
   3.67230570198892*^9, 3.6723057206922398`*^9}, 3.672305755948596*^9, {
   3.672305801156907*^9, 3.6723058151787443`*^9}, {3.6723062531481123`*^9, 
   3.672306263724231*^9}, 3.672306424340086*^9, {3.672307013153955*^9, 
   3.6723070165800047`*^9}, {3.672307188856908*^9, 3.6723072151743298`*^9}, 
   3.6723073310767517`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     SuperscriptBox["Null", "21"], "}"}], ",", 
    RowBox[{"{", "\[Placeholder]", "}"}], ",", 
    RowBox[{"{", "\[Placeholder]", "}"}], ",", 
    RowBox[{"{", "\[Placeholder]", "}"}]}], "}"}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["Null", "21"], ",", "\[Placeholder]", ",", "\[Placeholder]",
    ",", "\[Placeholder]"}], "}"}]], "Output",
 CellChangeTimes->{3.672306255124359*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671863670704685*^9, 3.6718636753286448`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6718635227095823`*^9}]
},
WindowSize->{808, 856},
WindowMargins->{{133, Automatic}, {57, Automatic}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 627, 10, 99, "Input"],
Cell[1210, 34, 288, 5, 32, "Output"]
}, Open  ]],
Cell[1513, 42, 91, 1, 32, InheritFromParent],
Cell[CellGroupData[{
Cell[1629, 47, 10066, 218, 1141, "Input"],
Cell[CellGroupData[{
Cell[11720, 269, 525, 7, 23, "Print"],
Cell[12248, 278, 523, 7, 23, "Print"]
}, Open  ]],
Cell[12786, 288, 1118, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13941, 309, 318, 9, 37, "Input"],
Cell[14262, 320, 207, 5, 35, "Output"]
}, Open  ]],
Cell[14484, 328, 94, 1, 32, "Input"],
Cell[14581, 331, 89, 1, 55, "Input"]
}
]
*)

(* End of internal cache information *)
