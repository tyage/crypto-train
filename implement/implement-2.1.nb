(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16243,        402]
NotebookOptionsPosition[     15855,        384]
NotebookOutlinePosition[     16192,        399]
CellTagsIndexPosition[     16149,        396]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[GridBox[{
   {
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ExEuclid", "[", 
        RowBox[{"s_", ",", "t_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "x", ",", "y", ",", "q"}], "}"}], ",", "\n", 
         RowBox[{
          RowBox[{"a", "=", 
           RowBox[{"{", 
            RowBox[{"s", ",", "t"}], "}"}]}], ";", "\n", 
          RowBox[{"x", "=", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], ";", "\n", 
          RowBox[{"y", "=", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ";", "\n", 
          RowBox[{"q", "=", 
           RowBox[{"{", "0", "}"}]}], ";", "\n", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "2"}], ",", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], ",", 
            RowBox[{"i", "++"}], ",", "\n", 
            RowBox[{
             RowBox[{"q", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"q", ",", 
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], "/", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", 
             RowBox[{"a", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"a", ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", 
             RowBox[{"x", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"q", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", 
             RowBox[{"y", "=", 
              RowBox[{"Insert", "[", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"q", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";", 
          "\n", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}], "]"}], ";"}]}],
         "\n", "]"}]}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ModBinary", "[", 
        RowBox[{"k_", ",", "g_", ",", "p_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"kBin", ",", "y", ",", "l", ",", "i"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"kBin", "=", 
           RowBox[{"IntegerDigits", "[", 
            RowBox[{"k", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", "g"}], ";", "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"Length", "[", "kBin", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "2"}], ",", 
            RowBox[{"i", "<=", "l"}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"kBin", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"y", "=", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"y", "^", "2"}], ",", "p"}], "]"}], "*", "g"}], 
                  ",", "p"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"y", "=", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"y", "^", "2"}], ",", "p"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "y", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"PowerModCRT", "[", 
        RowBox[{"p_", ",", "q_", ",", "a_", ",", "k_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "ecd", ",", "akp", ",", "akq"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"p", "*", "q"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ecd", "=", 
           RowBox[{"ExEuclid", "[", 
            RowBox[{"p", ",", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"akp", "=", 
           RowBox[{"ModBinary", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", 
               RowBox[{"p", "-", "1"}]}], "]"}], ",", "a", ",", "p"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"akq", "=", 
           RowBox[{"ModBinary", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"k", ",", 
               RowBox[{"q", "-", "1"}]}], "]"}], ",", "a", ",", "q"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"ChineseRemainder", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"akp", ",", "akq"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"p", ",", "q"}], "}"}]}], "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "p1", "=", 
       "1061381230189677514882994263710298546241228779418538773846724576275961\
850960273660519564105416621657196821736106154764089255703974072918634771312478\
9244883"}], ";"}], "\n", 
     RowBox[{
      RowBox[{
      "q1", "=", 
       "1157303566332719585384423884354286933387611493898947549900170830535765\
073217860830184828819928489991424813879528640654578560196897123171475537724826\
5509893"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "a1", "=", 
       "5517136991005143799041269078097691886400459440046805793699562639916993\
545964530929363827383901143322090384403297822308065100196316598314813890386646\
507034968771770748341696024760925769897674874015177207150576333584463725875843\
611616584746054957823806899324616427392859210459388248928910284838588982734886\
6771"}], ";"}], "\n", 
     RowBox[{
      RowBox[{
      "k1", "=", 
       "4790803212446670864050828211396166041485128160179973794784420229758404\
202954831447373512192239347898923647055028741276845024428026245342488520041070\
952254994809206872823194946734913741339098486811764228852716852146572363264396\
293076829064688036543959733544619328089043828142255591055214582450508641853068\
4390"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "p2", "=", 
       "1185308576313350599028620126936392113175536128220777180645421682390646\
304595611040401851811887198856133219777001517545802509656687566394740423159704\
8649687"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "q2", "=", 
       "1324147987978670006953767301340228371346130389501863872504371572833335\
118253599179169873045490567956934304166091040110449999896454196868870936052877\
1269943"}], ";"}], "\n", 
     RowBox[{
      RowBox[{
      "a2", "=", 
       "8273172872519490828922361766636745746952837762999234448689222799947380\
854573439360148163821388375508280500637706543978866124357334034953884823626133\
592304202545910273738194918701499926161168485143960116762066475445546988052650\
035954392695015391883077932595749925193640801344009225783196926450617219619953\
2825"}], ";"}], "\n", 
     RowBox[{
      RowBox[{
      "k2", "=", 
       "1510611613367997820279099488215310586749095034892255437441918572391793\
012087474799180275286680672639888302145292263587723560597448181975565700735725\
395153114171741349438840714148046233931768319143104364158663585331414086205295\
606796094054970175524650667906953003014085035728199079159048404723275421397090\
6224"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "p3", "=", 
       "9599724472077459170938409295351348996733286845593380723678287015797869\
376582994698717557159063112480487804057667202305112706638969543144364709193473\
048347"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "q3", "=", 
       "1215903644973925006060963098883622687320083884419002399847888102552041\
143768756987090689057956108167006853224742476546056472174913086351983944342428\
0486653"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "n3", "=", 
       "1167233997634437057085684596954891354662764095637453237404257136259107\
548677785843305743042743079604892507307297769548658802927423406950154320952050\
328146497566567848063044118665537806278220502218886859629268060292775049838705\
551120175870862496314002415030575648363831377331056181569808003421188049045572\
12591"}], ";"}], "\n", 
     RowBox[{
      RowBox[{
      "a3", "=", 
       "8767142442165238895064268964389619900644518589706463807405889616808859\
990326497086227968684417061150658016312045479484839313426559819240610153352861\
135763140223424827694230263035356103843587608138980102771917362219512572297170\
201601758500005347742292512987100804764044566077962563316222664354757374674334\
2095"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "k3", "=", 
       "8775639933869342577235886357222170288853027947321531508309154201012623\
195924064615409080926736780704644331846291899483997539515433714539205927346214\
190589329251925224986213568741208948106741169087981097957408494921032742856680\
538736893181295101313209078100697649416377297019783074295941829785132731715791\
04"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"loop", "=", "100"}], ";"}], "\n", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", "0"}], ",", 
             RowBox[{"i", "<", "loop"}], ",", 
             RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PowerModCRT", "[", 
               RowBox[{"p1", ",", "q1", ",", "a1", ",", "k1"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
     RowBox[{
      RowBox[{"Print", "[", "time", "]"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", "0"}], ",", 
             RowBox[{"i", "<", "loop"}], ",", 
             RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PowerModCRT", "[", 
               RowBox[{"p2", ",", "q2", ",", "a2", ",", "k2"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
     RowBox[{
      RowBox[{"Print", "[", "time", "]"}], ";"}], "\n", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", "0"}], ",", 
             RowBox[{"i", "<", "loop"}], ",", 
             RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PowerModCRT", "[", 
               RowBox[{"p3", ",", "q3", ",", "a3", ",", "k3"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
     RowBox[{
      RowBox[{"Print", "[", "time", "]"}], ";"}], "\n"}]},
   {"\[Placeholder]"},
   {"\[Placeholder]"}
  }]], "Input",
 CellChangeTimes->{{3.671862046087967*^9, 3.671862078319963*^9}, {
   3.671862237009542*^9, 3.671862353330172*^9}, {3.671862409766535*^9, 
   3.671862454031291*^9}, {3.6718625007785273`*^9, 3.671862538718364*^9}, {
   3.671862601543936*^9, 3.67186262767775*^9}, {3.671862668616598*^9, 
   3.6718628633131113`*^9}, {3.671862909826111*^9, 3.6718629405665913`*^9}, {
   3.671863060994432*^9, 3.67186309213417*^9}, {3.6718631324528513`*^9, 
   3.6718631824734583`*^9}, {3.6718632479033012`*^9, 3.671863248878524*^9}, {
   3.671863366862091*^9, 3.671863434368333*^9}, {3.6718635160852737`*^9, 
   3.671863526642702*^9}, {3.671863578612618*^9, 3.671863699695498*^9}, {
   3.671863810986182*^9, 3.671864063200452*^9}, 3.6718681453293133`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "Null", "}"}], ",", 
   RowBox[{"{", "\[Placeholder]", "}"}], ",", 
   RowBox[{"{", "\[Placeholder]", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.671862787821665*^9, 3.6718629411744947`*^9, {3.6718631739057503`*^9, 
   3.671863186543227*^9}, 3.671863434859201*^9, {3.671863618815948*^9, 
   3.671863636557551*^9}, {3.671863680564636*^9, 3.67186369386592*^9}, 
   3.671863744117017*^9, {3.671863806920247*^9, 3.671863842952221*^9}, {
   3.671863942936144*^9, 3.671863979708177*^9}, {3.671864015967807*^9, 
   3.671864045545726*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671863670704685*^9, 3.6718636753286448`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6718635227095823`*^9}]
},
WindowSize->{808, 933},
WindowMargins->{{Automatic, 776}, {Automatic, 0}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 14473, 339, 1696, "Input"],
Cell[15056, 363, 594, 12, 32, "Output"]
}, Open  ]],
Cell[15665, 378, 94, 1, 32, "Input"],
Cell[15762, 381, 89, 1, 55, "Input"]
}
]
*)

(* End of internal cache information *)
