(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11877,        297]
NotebookOptionsPosition[     11232,        271]
NotebookOutlinePosition[     11597,        287]
CellTagsIndexPosition[     11554,        284]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModBinary", "[", 
     RowBox[{"k_", ",", "g_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"kBin", ",", "y", ",", "l", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kBin", "=", 
        RowBox[{"IntegerDigits", "[", 
         RowBox[{"k", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", "=", "g"}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"Length", "[", "kBin", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "<=", "l"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"kBin", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"y", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"y", "^", "2"}], ",", "p"}], "]"}], "*", "g"}], ",",
                "p"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"y", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"y", "^", "2"}], ",", "p"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "y", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "1", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p1", "=", 
   "17976931348623159077083915679378745319786029604875601170644442368419718021\
615851936894783379586492554150218056548598050364644054819923910005079287700335\
581663922955313623907650873575991482257486257500742530207744771258955095793777\
842444242661733472762929938766870920560605027081084290769293201912819446762700\
7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "k1", "=", 
   "21378582330649381417469692753984792914127976226092048532580481084871644119\
000600141534929037897951342787125074054008389229149956876406489134126529473802\
073749006458927006539915539009546170378468358492975326911090841687069786303767\
086802217655374115072258330322914047273550235690898518749239"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModBinary", "[", 
   RowBox[{"k1", ",", "g1", ",", "p1"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "2", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p3", "=", 
   "13587344426488802082605577702277889444208928804182342167852955250747290794\
928076003157447123003883623449367517410681042951880955331532883594890525616772\
294060981006101360991271594769103809768312172598134172440472729715036887641375\
029257447603615740416150271691039282461219556595972238651837205433613215536004\
7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "k3", "=", 
   "57936722132444010413027888511389447221044644020911710839264776253736453974\
640380015787235615019418117246837587053405214759404776657664417974452628083861\
470304905030506804956357973845519048841560862990670862202363648575184438206875\
146287238018078702080751358455196412306097782979861193259186027168066077680023\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModBinary", "[", 
   RowBox[{"k3", ",", "g3", ",", "p3"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "3", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p4", "=", 
   "14110875533297471160681521826395812338118458821206101844813640482696588943\
307945378916621823037852222856405812786036719061106560537502554625753148936934\
406278252180697821880894009144765829835185360323706998059750516360247309561567\
099846439119730037293314777200949382303716764245937845273109255717090940694530\
9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "g4", "=", 
   "79207621787760038235763239269746451281552097558625763440050213854787240633\
084667257397421010854631623596917364929357681934505810865796708268321894884518\
347711092708958596829555918931536779252059763083320084867242870421484137196365\
244257388686997557137455046446997809953054632950185678637137955632299024284915\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k4", "=", "316477832003765415247735379263525718150288987267"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModBinary", "[", 
   RowBox[{"k4", ",", "g4", ",", "p4"}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "4", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop", "=", 
   RowBox[{"10", "^", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ExEuclid", "[", 
           RowBox[{"k1", ",", "g1", ",", "p1"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ExEuclid", "[", 
           RowBox[{"k3", ",", "g3", ",", "p3"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time3", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"time4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Timing", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "loop"}], ",", 
         RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ExEuclid", "[", 
           RowBox[{"k4", ",", "g4", ",", "p4"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "time4", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6706342279094343`*^9, 3.670634268757285*^9}, {
   3.6706349329224663`*^9, 3.67063493743746*^9}, {3.670635929359209*^9, 
   3.670636005506317*^9}, {3.6706483918376083`*^9, 3.670648398255396*^9}, {
   3.6706485822531233`*^9, 3.67064858782664*^9}, {3.670648654251841*^9, 
   3.6706486675003366`*^9}, {3.670648701049461*^9, 3.670649028021779*^9}, {
   3.670649110334165*^9, 3.6706491511033077`*^9}, 3.6706491942787943`*^9, {
   3.6706492425125847`*^9, 3.670649270255471*^9}, {3.6711834545714273`*^9, 
   3.671183580516405*^9}, {3.671184265743907*^9, 3.6711842882638597`*^9}, {
   3.6711843291235723`*^9, 3.6711844410659933`*^9}, {3.671184791501161*^9, 
   3.6711848037857037`*^9}}],

Cell[BoxData[\
"13521423718138082648495698372861138541183259043064644858172303183938170981778\
743570280893695849464533906849672775529154315181053041184820228377441358189866\
188108788279219379873263299526650210711075806066622902450524533574159325211422\
1378204403108914617845239415541282476848334205218793022801199211746923930986"]\
, "Output",
 CellChangeTimes->{{3.670648884111848*^9, 3.6706489020974607`*^9}, {
   3.670648959074188*^9, 3.670648991168729*^9}, {3.6706490220293713`*^9, 
   3.670649028350333*^9}, {3.670649114717492*^9, 3.670649131795735*^9}, 
   3.670649163144546*^9, 3.6706491948899918`*^9, {3.670649247928794*^9, 
   3.67064926460079*^9}, 3.6711834998864527`*^9, 3.6711836315794353`*^9, 
   3.671184441814126*^9, 3.671184798638687*^9}],

Cell[BoxData[\
"52932370459922034113764614821953296520770529450536214818167053884126292756294\
276927090914664546828353299142451682923279102021250357234505511979300050656883\
743469078105311087173405561133181492655185494786805042785407484740251962514038\
67744932860646943069801550900839308878984203966834349906055284640037186905"], \
"Output",
 CellChangeTimes->{{3.670648884111848*^9, 3.6706489020974607`*^9}, {
   3.670648959074188*^9, 3.670648991168729*^9}, {3.6706490220293713`*^9, 
   3.670649028350333*^9}, {3.670649114717492*^9, 3.670649131795735*^9}, 
   3.670649163144546*^9, 3.6706491948899918`*^9, {3.670649247928794*^9, 
   3.67064926460079*^9}, 3.6711834998864527`*^9, 3.6711836315794353`*^9, 
   3.671184441814126*^9, 3.671184798644609*^9}],

Cell[BoxData[\
"11319406312174517136908894031110079956020685654325371327756351092700631051956\
955990630037599211639095046698650793668816201946966583861727761506355565840434\
968459891867180201750266909451035437360054511543135969220228089036415998281198\
2641197523369628889095171321243765313870105291167275272463466578713957325721"]\
, "Output",
 CellChangeTimes->{{3.670648884111848*^9, 3.6706489020974607`*^9}, {
   3.670648959074188*^9, 3.670648991168729*^9}, {3.6706490220293713`*^9, 
   3.670649028350333*^9}, {3.670649114717492*^9, 3.670649131795735*^9}, 
   3.670649163144546*^9, 3.6706491948899918`*^9, {3.670649247928794*^9, 
   3.67064926460079*^9}, 3.6711834998864527`*^9, 3.6711836315794353`*^9, 
   3.671184441814126*^9, 3.671184798649004*^9}],

Cell[CellGroupData[{

Cell[BoxData["1.063`*^-6"], "Print",
 CellChangeTimes->{3.6711844418587627`*^9, 3.6711847986534224`*^9}],

Cell[BoxData["8.91`*^-7"], "Print",
 CellChangeTimes->{3.6711844418587627`*^9, 3.671184798657987*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.6711844418587627`*^9, 3.671184798667317*^9}],

Cell[BoxData["9.64`*^-7"], "Print",
 CellChangeTimes->{3.6711844418587627`*^9, 3.671184798674727*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "y", "]"}], ";"}], "\[IndentingNewLine]"}]], "Input"]
},
WindowSize->{808, 751},
WindowMargins->{{Automatic, 65}, {Automatic, 25}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (2016\:5e743\
\:67081\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7797, 187, 1644, "Input"],
Cell[8380, 211, 757, 11, 80, "Output"],
Cell[9140, 224, 755, 11, 80, "Output"],
Cell[9898, 237, 757, 11, 80, "Output"],
Cell[CellGroupData[{
Cell[10680, 252, 104, 1, 23, "Print"],
Cell[10787, 255, 101, 1, 23, "Print"],
Cell[10891, 258, 93, 1, 21, "Print"],
Cell[10987, 261, 101, 1, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[11115, 266, 113, 3, 61, "Input"]
}
]
*)

