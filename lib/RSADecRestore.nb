(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8818,        220]
NotebookOptionsPosition[      8508,        204]
NotebookOutlinePosition[      8846,        219]
CellTagsIndexPosition[      8803,        216]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Load", "[", "\"\<./lib/ExEuclid.nb\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Load", "[", "\"\<./lib/Inv.nb\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RSADecRestore", "[", 
    RowBox[{
    "k_", ",", "n_", ",", "e_", ",", "vk_", ",", "c_", ",", "delta_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "edash", ",", "lambda", ",", "t", ",", "omega", ",", "j", ",", "ab", 
       ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edash", "=", 
       RowBox[{"4", "*", 
        RowBox[{"Power", "[", 
         RowBox[{"delta", ",", "2"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"omega", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "k"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lambda", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ",", 
           RowBox[{"t", "\[LessEqual]", "k"}], ",", 
           RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"t", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"lambda", "*=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"0", "-", 
                   RowBox[{
                    RowBox[{"vk", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"vk", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"vk", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"omega", "*=", 
          RowBox[{"PowerMod", "[", 
           RowBox[{"c", ",", 
            RowBox[{"edash", "*", "lambda", "*", 
             RowBox[{
              RowBox[{"vk", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "n"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ab", "=", 
       RowBox[{"ExEuclid", "[", 
        RowBox[{"edash", ",", "e"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"PowerMod", "[", 
           RowBox[{"omega", ",", 
            RowBox[{"ab", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "n"}], "]"}], "*", 
          RowBox[{"PowerMod", "[", 
           RowBox[{"c", ",", 
            RowBox[{"ab", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "n"}], "]"}]}], ",", "n"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "M", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e", "=", "65537"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "n", "=", 
   "13591512344510680687560950380441184503271234743698030476675440575641149160\
314686744927595567408160527501895517236361733459194689421476413238647582360217\
258339929388132019756263306505279019655418758436074931176821711268424605537412\
180977889934060234467179506737152340840971278992283598201393193905995070720268\
1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"delta", "=", 
   RowBox[{"5", "*", "4", "*", "3", "*", "2", "*", "1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vk", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", 
       "2401145612564556309013879252636982034220020348694605688277629860251072\
923075459573891462881272592705177386095445134358548770320844248188074199907284\
347614476909462030038421282831604326348535569909285139199659607824167721456690\
461880002919695373681709292193647661114821883546982051784470903422719222361867\
6074"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", 
       "3126649355465272461279444368311071258222839304783055566224311235861666\
520576498410664055540779640980559189659452332022794405549412964711042426181061\
178151210700871332093127457201181130451876493295964070588121800278141861705855\
190004258639944512890290351955505447940967088591708590579454616038022790065078\
5083"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", 
       "1899319735158333506761682999566080569459671577578994904024708952635560\
139922528444039584342975640264562712338461453057976706325527296255889612975626\
859141106453940183736372375486109146220427184383396448633165603665638162914250\
437802257463931700332093339314017141523272312176084365612735518831198928929978\
6304"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", 
       "1300348139891244986380926853235477747187592180371291719691906916001750\
541808019673346479589176889181129061930304145669440855595446539799381593009244\
634520341909953054346381338950312993157066316706143867570976942667796427730438\
060950720694889923254857612977195992532858583544044025451044187643354032595856\
3316"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", 
       "1129993620055602254283794013366049957877516152423475733713215075126662\
739048235539875786628417119899612017935288417401400624330875403514150383513738\
981746505059054984006281653184074053935931417063734379935699222112745451758547\
179632627251511427089986505250693681177121566795844280997095782347597042718825\
1972"}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "c", "=", 
   "12207333882407946002394548329582406652882039104089794647623376404561163015\
587254248285754773792277848346588680459721223225095642207153721722620052801131\
633290151259781886506770590066262430262898236404590126315090446586275724856498\
675861193624155921982433184543144652380918505890481469793549228766654954121841\
4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"RSADecRestore", "[", 
  RowBox[{"k", ",", "n", ",", "e", ",", "vk", ",", "c", ",", "delta"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.678946718433135*^9, 3.67894673662101*^9}, {
  3.678946789723893*^9, 3.678946855021336*^9}, {3.678947138019034*^9, 
  3.678947222995524*^9}, {3.67894727133673*^9, 3.678947294489929*^9}, {
  3.6789473409731207`*^9, 3.678947463266218*^9}, {3.678947506895286*^9, 
  3.678947536675871*^9}, {3.678947650608222*^9, 3.6789476548810663`*^9}, {
  3.678947919728117*^9, 3.678947930280334*^9}, {3.678947963891183*^9, 
  3.6789479716919727`*^9}, {3.6789480370576057`*^9, 3.67894814053232*^9}, {
  3.678948245664838*^9, 3.678948298136181*^9}, {3.678948428444665*^9, 
  3.67894843049979*^9}, {3.678948723326804*^9, 3.678948757023682*^9}, {
  3.678948812615717*^9, 3.678948823105545*^9}, {3.678948878864257*^9, 
  3.6789488933485107`*^9}}],

Cell[BoxData["413220302632228308322579572702365948474633180206"], "Output",
 CellChangeTimes->{{3.678947457527041*^9, 3.6789474641877823`*^9}, {
   3.678947511728085*^9, 3.678947537612379*^9}, 3.67894765668956*^9, 
   3.678948185257352*^9, {3.6789482564107227`*^9, 3.678948298904208*^9}, 
   3.678948433455839*^9, {3.678948817301311*^9, 3.678948836663361*^9}, 
   3.6789488952620907`*^9}]
}, Open  ]]
},
WindowSize->{808, 933},
WindowMargins->{{Automatic, 123}, {19, Automatic}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7521, 172, 1551, "Input"],
Cell[8104, 196, 388, 5, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
