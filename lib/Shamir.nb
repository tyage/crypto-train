Notebook[{Cell[
CellGroupData[{Cell[
BoxData[{RowBox[{"ShamirGenShare","[","k_",",","n_",",","q_",",","idlist_",",","a_","]",":=","Module","[","{","result",",","x",",","v",",","i",",","j","}",",","\n","result","=","{","}",";","\n","For","[","i","=","1",",","i","\[LessEqual]","n",",","i","+=","1",",","\n","x"," ","="," ","idlist","[","[","i","]","]",";","\n","v","=","0",";","\n","For","[","j","=","1",",","j","\[LessEqual]","k",",","j","+=","1",",","\n","v"," ","+="," ","a","[","[","j","]","]"," ","*","x","^","(","j","-","1",")",";","\n","]",";","\n","AppendTo","[","result",","," ","{","x",","," ","Mod","[","v",",","q","]","}","]",";","\n","]",";","\n","Return","[","result","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ShamirRestoreSec","[","k_",",","q_",",","vk_","]",":=","Module","[","{","s",",","idlist",",","i",",","l",",","t","}",",","\n","idlist","=","{","}",";","\n","For","[","i","=","1",",","i","\[LessEqual]","k",",","i","+=","1",",","\n","AppendTo","[","idlist",",","vk","[","[","i","]","]","[","[","1","]","]","]",";","\n","]",";","\n","\n","s","=","0",";","\n","For","[","i","=","1",",","i","\[LessEqual]","k",",","i","+=","1",",","\n","l","=","1",";","\n","For","[","t","=","1",",","t","\[LessEqual]","k",",","t","+=","1",",","\n","If","[","t","\[NotEqual]","i",",","\n","l","*=","Mod","[","-","idlist","[","[","t","]","]"," ","*"," ","PowerMod","[","idlist","[","[","i","]","]","-","idlist","[","[","t","]","]",",","-","1",",","q","]",",","q","]",";","\n","]",";","\n","]",";","\n","s"," ","+="," ","l","*","vk","[","[","i","]","]","[","[","2","]","]",";","\n","]",";","\n","Return","[","Mod","[","s",",","q","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ShamirVerifyShare","[","k_",",","v_",",","g_",",","y_",",","p_","]",":=","Module","[","{","i",",","j",",","gsum","}",",","\n","i","=","v","[","[","1","]","]",";","\n","gsum","=","1",";","\n","For","[","j","=","1",",","j","\[LessEqual]","k",",","j","+=","1",",","\n","gsum","=","Mod","[","gsum","*","PowerMod","[","y","[","[","j","]","]",",","i","^","(","j","-","1",")",",","p","]",",","p","]",";","\n","]",";","\n","Return","[","gsum","==","PowerMod","[","g",",","v","[","[","2","]","]",",","p","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ModMatInverse","[","m_",",","q_","]",":=","Module","[","{","}",",","\n","Return","[","Inverse","[","m",",","Modulus","\[Rule]","q","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"k"," ","="," ","3",";"}],"\n",RowBox[{"n"," ","="," ","5",";"}],"\n","\n",RowBox[
{"idlist"," ","="," ","{","1",","," ","2",","," ","3",","," ","4",","," ","5","}",";"}],"\n","\n",RowBox[
{"p"," ","="," ","141108755332974711606815218263958123381184588212061018448136404826965889433079453789166218230378522228564058127860367190611065605375025546257531489369344062782521806978218808940091447658298351853603237069980597505163602473095615670998464391197300372933147772009493823037167642459378452731092557170909406945309",";"}],"\n","\n",RowBox[
{"g"," ","="," ","79207621787760038235763239269746451281552097558625763440050213854787240633084667257397421010854631623596917364929357681934505810865796708268321894884518347711092708958596829555918931536779252059763083320084867242870421484137196365244257388686997557137455046446997809953054632950185678637137955632299024284915",";"}],"\n","\n",RowBox[
{"q"," ","="," ","1362115923099293242369922261305212343561846087883",";"}],"\n","\n",RowBox[
{"a"," ","="," ","{","1221998584672970114579031532646167781989772961809",",","769787308636921413393730224027103814972700692660",",","944334248995195723646884914141647507780134156034","}",";"}],"\n","\n",RowBox[
{"vk"," ","="," ","{","\n"," ","{","1",",","977561920990959753535971357733072209780821137869","}",",","\n"," ","{","2",",","893629879853444493603157568318259127611569195444","}",",","\n"," ","{","3",",","1204715998726421027143400146393038489763188914009","}","\n","}",";"}],"\n","\n",RowBox[
{"y"," ","="," ","{","48392623839047314006704164584453605966561329514677687317994846584480861308286730270346942619100085243049012373322404934254465302236309305508460589277207508356142714029617941430865018464738406368059980443181652723605133407535904407559761076852476251117053545800136331917468158378236682702874542002056416997658",",","\n","73786652351015743930661481622179580801513700353967831705617802481301100480976588611163385020137977529326060423880200386960387699787032587076919949515121746041419621759301852948025147503264644974374319373036930415085988344597340469176248593499085138789815513195291517637362546661600624102610869827914798102258",",","\n","56998538135991751976857136766664756785254643087831943717455385442421762236600152347626393532398181024102746066490200894998320103855400508519527149483667747022225334170557946834719579708618483377536996532626104825951106902751248784466342682988978349410197394579936770289875696190275242032482074638312725114515","}",";"}],"\n","\n",RowBox[
{"v"," ","="," ","{","5",",","74856967652312182951438018913415336557862480416","}",";"}],"\n","\n",RowBox[
{"m"," ","="," ","{","\n"," ","{","1128644637475487277437064239193417968364553102162",","," ","\n",StyleBox[
RowBox[{" "," "}]],"1057558915517085079856096853356709710619040837372","}",",","\n"," ","{","742397819762769075148532728202973389269120018469",","," ","\n",StyleBox[
RowBox[{" "," "}]],"1009874539461064471401823653241049485436607266014","}","\n","}",";"}],"\n","\n",RowBox[
{"s","=","ShamirRestoreSec","[","k",",","q",",","vk","]"}],"\n",RowBox[{"vn","=","ShamirGenShare","[","k",",","n",",","q",",","idlist",",","a","]"}],"\n",RowBox[
{"ShamirVerifyShare","[","k",",","v",",","g",",","y",",","p","]"}],"\n",RowBox[{"ModMatInverse","[","m",",","q","]"}]}],
"Input",CellID->1,CellLabel->"In[240]:= "],Cell[
BoxData["94396199039673564571919253332265392709098653401",
StandardForm],"Output",CellID->70,CellLabel->"Out[255]= "],Cell[
BoxData[RowBox[{"{",RowBox[
{RowBox[{"{",RowBox[{"1",",","211888296106500766879802148204494417618915634737"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","1090446505530422866474342592046116068808326619733"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","1133441366746149928622808341560608048434313741031"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","340872879753681953325199396747970356496876998631"}],"}"}],",",RowBox[
{"{",RowBox[{"5",",","74856967652312182951438018913415336557862480416"}],"}"}]}],"}"}],
StandardForm],"Output",CellID->72,CellLabel->"Out[256]= "],Cell[
BoxData["True",StandardForm],
"Output",CellID->73,CellLabel->"Out[257]= "],Cell[
BoxData[RowBox[{"{",RowBox[{RowBox[
{"{",RowBox[{"729352349536478112151691213283009095209084788709",",","226676475696915987363605282964918826899014951941"}],"}"}],",",RowBox[
{"{",RowBox[{"561268480002266905087617712267950683021905426505",",","281319142908251993062444954586941128441576327107"}],"}"}]}],"}"}],
StandardForm],"Output",CellID->74,CellLabel->"Out[258]= "]},Open]],Cell[
BoxData[
RowBox[{}]],"Input",CellID->78]},StyleDefinitions->"Default.nb",FrontEndVersion->"10.0 for Wolfram Cloud Platform (June 2 2014)"]