(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11465,        296]
NotebookOptionsPosition[     10740,        267]
NotebookOutlinePosition[     11077,        282]
CellTagsIndexPosition[     11034,        279]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "p3", "=", 
   "13587344426488802082605577702277889444208928804182342167852955250747290794\
928076003157447123003883623449367517410681042951880955331532883594890525616772\
294060981006101360991271594769103809768312172598134172440472729715036887641375\
029257447603615740416150271691039282461219556595972238651837205433613215536004\
7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "l3", "=", 
   "67936722132444010413027888511389447221044644020911710839264776253736453974\
640380015787235615019418117246837587053405214759404776657664417974452628083861\
470304905030506804956357973845519048841560862990670862202363648575184438206875\
146287238018078702080751358455196412306097782979861193259186027168066077680023\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "k3", "=", 
   "57936722132444010413027888511389447221044644020911710839264776253736453974\
640380015787235615019418117246837587053405214759404776657664417974452628083861\
470304905030506804956357973845519048841560862990670862202363648575184438206875\
146287238018078702080751358455196412306097782979861193259186027168066077680023\
"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "r3", "=", 
    "4793672213244401041302788851138944722104464402091171083926477625373645397\
464038001578723561501941811724683758705340521475940477665766441797445262808386\
147030490503050680495635797384551904884156086299067086220236364857518443820687\
514628723801807870208075135845519641230609778297986119325918602716806607768002\
3"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "p4", "=", 
   "14110875533297471160681521826395812338118458821206101844813640482696588943\
307945378916621823037852222856405812786036719061106560537502554625753148936934\
406278252180697821880894009144765829835185360323706998059750516360247309561567\
099846439119730037293314777200949382303716764245937845273109255717090940694530\
9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "g4", "=", 
   "79207621787760038235763239269746451281552097558625763440050213854787240633\
084667257397421010854631623596917364929357681934505810865796708268321894884518\
347711092708958596829555918931536779252059763083320084867242870421484137196365\
244257388686997557137455046446997809953054632950185678637137955632299024284915\
"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"l4", "=", "1362115923099293242369922261305212343561846087883"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k4", "=", "316477832003765415247735379263525718150288987267"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"r4", "=", "1316477832003765415247735379263525718150288987267"}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "\"\<This is an exercise of Schnorr signature.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y3", "=", 
   RowBox[{"SchnorrKeyGen", "[", 
    RowBox[{"g3", ",", "k3", ",", "p3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"signature3", "=", 
   RowBox[{"SchnorrSign", "[", 
    RowBox[{"m", ",", "k3", ",", "g3", ",", "l3", ",", "r3", ",", "p3"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "signature3", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y4", "=", 
   RowBox[{"SchnorrKeyGen", "[", 
    RowBox[{"g4", ",", "k4", ",", "p4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"signature4", "=", 
   RowBox[{"SchnorrSign", "[", 
    RowBox[{"m", ",", "k4", ",", "g4", ",", "l4", ",", "r4", ",", "p4"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "signature4", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v3", "=", 
   RowBox[{"SchnorrVerify", "[", 
    RowBox[{"signature3", ",", "m", ",", "y3", ",", "g3", ",", "p3"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "v3", "]"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v4", "=", 
   RowBox[{"SchnorrVerify", "[", 
    RowBox[{"signature4", ",", "m", ",", "y4", ",", "g4", ",", "p4"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "v4", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MeanTiming", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanTiming", "[", 
    RowBox[{"f_", ",", "loop_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Timing", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "0"}], ",", 
             RowBox[{"i", "<", "loop"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"f", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}], "\[IndentingNewLine]", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "loop"}], "\[IndentingNewLine]",
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MeanTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SchnorrSign", "[", 
     RowBox[{"m", ",", "k3", ",", "g3", ",", "l3", ",", "r3", ",", "p3"}], 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "loop"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"BitLength", "[", "l3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MeanTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SchnorrSign", "[", 
     RowBox[{"m", ",", "k4", ",", "g4", ",", "l4", ",", "r4", ",", "p4"}], 
     "]"}], ";"}], "\[IndentingNewLine]", ",", "loop"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BitLength", "[", "l4", "]"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.673602784471428*^9, 3.673602785565366*^9}, {
   3.673603372911633*^9, 3.673603415891386*^9}, 3.673603452695003*^9, {
   3.673603493102173*^9, 3.6736035552041597`*^9}, {3.6736035940508013`*^9, 
   3.673603616957712*^9}, {3.67360389136331*^9, 3.673603946915165*^9}, {
   3.673604012174863*^9, 3.673604036724266*^9}, {3.6736040682859383`*^9, 
   3.6736041044221783`*^9}, {3.673604281231393*^9, 3.673604297630677*^9}, {
   3.673604829458961*^9, 3.673604832017344*^9}, {3.673604862362414*^9, 
   3.673604862670722*^9}, {3.673604908262809*^9, 3.6736049160130787`*^9}, {
   3.673605042325653*^9, 3.673605059625361*^9}, {3.6736052148271923`*^9, 
   3.673605215721909*^9}, {3.673605275036762*^9, 3.673605275607327*^9}, {
   3.673605305794359*^9, 3.6736053329814*^9}, {3.673605385699634*^9, 
   3.673605391589428*^9}, {3.673605425499896*^9, 3.673605439285408*^9}, {
   3.673606040263186*^9, 3.67360608496452*^9}, {3.673607940610795*^9, 
   3.673607942647431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "77775127310975671521382121379162698423107418853", ",", 
   "52400004764350597515349133940981703214210217018080572524586047696038584344\
573458899704703084625051156596620763182871435640672822128797010293130047078519\
451101006184070198992026839618951223241397102002103044147715423783852610505605\
676634899976875473244634098352726870133144083630967680060366865321818462461701\
"}], "}"}]], "Print",
 CellChangeTimes->{3.67360403752915*^9, 3.673604104931655*^9, 
  3.673604287786488*^9, 3.673604325364852*^9, 3.673604821016963*^9, 
  3.673605065375535*^9, 3.673605333700924*^9, 3.673605392095223*^9, 
  3.673605439708164*^9, 3.673606090128544*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "804931456388734118972993320422182454592834910811", ",", 
   "1008913413342001467614526664898571508988176480539"}], "}"}]], "Print",
 CellChangeTimes->{3.67360403752915*^9, 3.673604104931655*^9, 
  3.673604287786488*^9, 3.673604325364852*^9, 3.673604821016963*^9, 
  3.673605065375535*^9, 3.673605333700924*^9, 3.673605392095223*^9, 
  3.673605439708164*^9, 3.673606090153511*^9}],

Cell[BoxData["True"], "Print",
 CellChangeTimes->{3.67360403752915*^9, 3.673604104931655*^9, 
  3.673604287786488*^9, 3.673604325364852*^9, 3.673604821016963*^9, 
  3.673605065375535*^9, 3.673605333700924*^9, 3.673605392095223*^9, 
  3.673605439708164*^9, 3.673606090166654*^9}],

Cell[BoxData["True"], "Print",
 CellChangeTimes->{3.67360403752915*^9, 3.673604104931655*^9, 
  3.673604287786488*^9, 3.673604325364852*^9, 3.673604821016963*^9, 
  3.673605065375535*^9, 3.673605333700924*^9, 3.673605392095223*^9, 
  3.673605439708164*^9, 3.6736060901772213`*^9}]
}, Open  ]],

Cell[BoxData["0.016405025`"], "Output",
 CellChangeTimes->{3.673605073793548*^9, 3.673605333751061*^9, 
  3.673605400384787*^9, 3.6736054397565727`*^9, 3.673606107463192*^9}],

Cell[BoxData["1023"], "Output",
 CellChangeTimes->{3.673605073793548*^9, 3.673605333751061*^9, 
  3.673605400384787*^9, 3.6736054397565727`*^9, 3.673606107464645*^9}],

Cell[BoxData["0.007272454`"], "Output",
 CellChangeTimes->{3.673605073793548*^9, 3.673605333751061*^9, 
  3.673605400384787*^9, 3.6736054397565727`*^9, 3.6736061152756367`*^9}],

Cell[BoxData["160"], "Output",
 CellChangeTimes->{3.673605073793548*^9, 3.673605333751061*^9, 
  3.673605400384787*^9, 3.6736054397565727`*^9, 3.6736061152770433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "BitLength", "[", "804931456388734118972993320422182454592834910811", 
    "]"}], "\[IndentingNewLine]", "\t"}]}]], "Input",
 CellChangeTimes->{{3.673602782921628*^9, 3.6736027829452543`*^9}, 
   3.673602918984661*^9, {3.673606998253664*^9, 3.67360701285406*^9}}],

Cell[BoxData["160"], "Output",
 CellChangeTimes->{3.673607013719253*^9}]
}, Open  ]]
},
WindowSize->{808, 731},
WindowMargins->{{Automatic, 101}, {Automatic, 8}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7287, 172, 1771, "Input"],
Cell[CellGroupData[{
Cell[7892, 198, 688, 12, 119, "Print"],
Cell[8583, 212, 422, 8, 43, "Print"],
Cell[9008, 222, 278, 4, 23, "Print"],
Cell[9289, 228, 280, 4, 23, "Print"]
}, Open  ]],
Cell[9584, 235, 174, 2, 32, "Output"],
Cell[9761, 239, 166, 2, 32, "Output"],
Cell[9930, 243, 176, 2, 32, "Output"],
Cell[10109, 247, 167, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10313, 254, 336, 7, 77, "Input"],
Cell[10652, 263, 72, 1, 32, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
