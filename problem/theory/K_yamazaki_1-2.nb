Notebook[{Cell[
CellGroupData[{Cell[
BoxData[{RowBox[{"ShamirGenShare","[","k_",",","n_",",","q_",",","idlist_",",","a_","]",":=","Module","[","{","result",",","x",",","v",",","i",",","j","}",",","\n","result","=","{","}",";","\n","For","[","i","=","1",",","i","\[LessEqual]","n",",","i","+=","1",",","\n","x"," ","="," ","idlist","[","[","i","]","]",";","\n","v","=","0",";","\n","For","[","j","=","1",",","j","\[LessEqual]","k",",","j","+=","1",",","\n","v"," ","+="," ","a","[","[","j","]","]"," ","*","x","^","(","j","-","1",")",";","\n","]",";","\n","AppendTo","[","result",","," ","{","x",","," ","Mod","[","v",",","q","]","}","]",";","\n","]",";","\n","Return","[","result","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ShamirRestoreSec","[","k_",",","q_",",","vk_","]",":=","Module","[","{","s",",","idlist",",","i",",","l",",","t","}",",","\n","idlist","=","{","}",";","\n","For","[","i","=","1",",","i","\[LessEqual]","k",",","i","+=","1",",","\n","AppendTo","[","idlist",",","vk","[","[","i","]","]","[","[","1","]","]","]",";","\n","]",";","\n","\n","s","=","0",";","\n","For","[","i","=","1",",","i","\[LessEqual]","k",",","i","+=","1",",","\n","l","=","1",";","\n","For","[","t","=","1",",","t","\[LessEqual]","k",",","t","+=","1",",","\n","If","[","t","\[NotEqual]","i",",","\n","l","*=","Mod","[","-","idlist","[","[","t","]","]"," ","*"," ","PowerMod","[","idlist","[","[","i","]","]","-","idlist","[","[","t","]","]",",","-","1",",","q","]",",","q","]",";","\n","]",";","\n","]",";","\n","s"," ","+="," ","l","*","vk","[","[","i","]","]","[","[","2","]","]",";","\n","]",";","\n","Return","[","Mod","[","s",",","q","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ShamirVerifyShare","[","k_",",","v_",",","g_",",","y_",",","p_","]",":=","Module","[","{","i",",","j",",","gsum","}",",","\n","i","=","v","[","[","1","]","]",";","\n","gsum","=","1",";","\n","For","[","j","=","1",",","j","\[LessEqual]","k",",","j","+=","1",",","\n","gsum","=","Mod","[","gsum","*","PowerMod","[","y","[","[","j","]","]",",","i","^","(","j","-","1",")",",","p","]",",","p","]",";","\n","]",";","\n","Return","[","gsum","==","PowerMod","[","g",",","v","[","[","2","]","]",",","p","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"ModMatInverse","[","m_",",","q_","]",":=","Module","[","{","}",",","\n","Return","[","Inverse","[","m",",","Modulus","\[Rule]","q","]","]",";","\n","]",";"}],"\n","\n",RowBox[
{"k"," ","="," ","3",";"}],"\n",RowBox[{"n"," ","="," ","5",";"}],"\n","\n",RowBox[
{"idlist"," ","="," ","{","1",","," ","2",","," ","3",","," ","4",","," ","5","}",";"}],"\n","\n",RowBox[
{"p"," ","="," ","141108755332974711606815218263958123381184588212061018448136404826965889433079453789166218230378522228564058127860367190611065605375025546257531489369344062782521806978218808940091447658298351853603237069980597505163602473095615670998464391197300372933147772009493823037167642459378452731092557170909406945309",";"}],"\n","\n",RowBox[
{"g"," ","="," ","79207621787760038235763239269746451281552097558625763440050213854787240633084667257397421010854631623596917364929357681934505810865796708268321894884518347711092708958596829555918931536779252059763083320084867242870421484137196365244257388686997557137455046446997809953054632950185678637137955632299024284915",";"}],"\n","\n",RowBox[
{"q"," ","="," ","1362115923099293242369922261305212343561846087883",";"}],"\n","\n",RowBox[
{"a"," ","="," ","{","1221998584672970114579031532646167781989772961809",",","769787308636921413393730224027103814972700692660",",","944334248995195723646884914141647507780134156034","}",";"}],"\n","\n",RowBox[
{"vk"," ","="," ","{","\n"," ","{","1",",","977561920990959753535971357733072209780821137869","}",",","\n"," ","{","2",",","893629879853444493603157568318259127611569195444","}",",","\n"," ","{","3",",","1204715998726421027143400146393038489763188914009","}","\n","}",";"}],"\n","\n",RowBox[
{"y"," ","="," ","{","48392623839047314006704164584453605966561329514677687317994846584480861308286730270346942619100085243049012373322404934254465302236309305508460589277207508356142714029617941430865018464738406368059980443181652723605133407535904407559761076852476251117053545800136331917468158378236682702874542002056416997658",",","\n","73786652351015743930661481622179580801513700353967831705617802481301100480976588611163385020137977529326060423880200386960387699787032587076919949515121746041419621759301852948025147503264644974374319373036930415085988344597340469176248593499085138789815513195291517637362546661600624102610869827914798102258",",","\n","56998538135991751976857136766664756785254643087831943717455385442421762236600152347626393532398181024102746066490200894998320103855400508519527149483667747022225334170557946834719579708618483377536996532626104825951106902751248784466342682988978349410197394579936770289875696190275242032482074638312725114515","}",";"}],"\n","\n",RowBox[
{"v"," ","="," ","{","5",",","74856967652312182951438018913415336557862480416","}",";"}],"\n","\n",RowBox[
{"m"," ","="," ","{","\n"," ","{","1128644637475487277437064239193417968364553102162",","," ","\n",StyleBox[
RowBox[{" "," "}]],"1057558915517085079856096853356709710619040837372","}",",","\n"," ","{","742397819762769075148532728202973389269120018469",","," ","\n",StyleBox[
RowBox[{" "," "}]],"1009874539461064471401823653241049485436607266014","}","\n","}",";"}],"\n","\n",RowBox[
{"s","=","ShamirRestoreSec","[","k",",","q",",","vk","]"}],"\n",RowBox[{"vn","=","ShamirGenShare","[","k",",","n",",","q",",","idlist",",","a","]"}],"\n",RowBox[
{"ShamirVerifyShare","[","k",",","v",",","g",",","y",",","p","]"}],"\n",RowBox[{"ModMatInverse","[","m",",","q","]"}]}],
"Input",CellID->1,CellLabel->"In[240]:= "],Cell[
BoxData["94396199039673564571919253332265392709098653401",
StandardForm],"Output",CellID->70,CellLabel->"Out[255]= "],Cell[
BoxData[RowBox[{"{",RowBox[
{RowBox[{"{",RowBox[{"1",",","211888296106500766879802148204494417618915634737"}],"}"}],",",RowBox[
{"{",RowBox[{"2",",","1090446505530422866474342592046116068808326619733"}],"}"}],",",RowBox[
{"{",RowBox[{"3",",","1133441366746149928622808341560608048434313741031"}],"}"}],",",RowBox[
{"{",RowBox[{"4",",","340872879753681953325199396747970356496876998631"}],"}"}],",",RowBox[
{"{",RowBox[{"5",",","74856967652312182951438018913415336557862480416"}],"}"}]}],"}"}],
StandardForm],"Output",CellID->72,CellLabel->"Out[256]= "],Cell[
BoxData["True",StandardForm],
"Output",CellID->73,CellLabel->"Out[257]= "],Cell[
BoxData[RowBox[{"{",RowBox[{RowBox[
{"{",RowBox[{"729352349536478112151691213283009095209084788709",",","226676475696915987363605282964918826899014951941"}],"}"}],",",RowBox[
{"{",RowBox[{"561268480002266905087617712267950683021905426505",",","281319142908251993062444954586941128441576327107"}],"}"}]}],"}"}],
StandardForm],"Output",CellID->74,CellLabel->"Out[258]= "]},Open]],Cell[
CellGroupData[
{Cell[
BoxData[{RowBox[{"k"," ","="," ","6",";"}],"\n",RowBox[{"n"," ","="," ","100",";"}],"\n","\n",RowBox[
{"idlist"," ","="," ","{","1",","," ","2",","," ","3",","," ","4",","," ","5",","," ","6",","," ","7",","," ","8",","," ","9",","," ","10",","," ","11",","," ","12",","," ","13",","," ","14",","," ","15",","," ","16",","," ","17",","," ","18",","," ","\n","19",","," ","20",","," ","21",","," ","22",","," ","23",","," ","24",","," ","25",","," ","26",","," ","27",","," ","28",","," ","29",","," ","30",","," ","31",","," ","32",","," ","33",","," ","34",","," ","35",","," ","36",","," ","\n","37",","," ","38",","," ","39",","," ","40",","," ","41",","," ","42",","," ","43",","," ","44",","," ","45",","," ","46",","," ","47",","," ","48",","," ","49",","," ","50",","," ","51",","," ","52",","," ","53",","," ","54",","," ","\n","55",","," ","56",","," ","57",","," ","58",","," ","59",","," ","60",","," ","61",","," ","62",","," ","63",","," ","64",","," ","65",","," ","66",","," ","67",","," ","68",","," ","69",","," ","70",","," ","71",","," ","72",","," ","\n","73",","," ","74",","," ","75",","," ","76",","," ","77",","," ","78",","," ","79",","," ","80",","," ","81",","," ","82",","," ","83",","," ","84",","," ","85",","," ","86",","," ","87",","," ","88",","," ","89",","," ","90",","," ","\n","91",","," ","92",","," ","93",","," ","94",","," ","95",","," ","96",","," ","97",","," ","98",","," ","99",","," ","100","}",";"}],"\n","\n",RowBox[
{"p"," ","="," ","141108755332974711606815218263958123381184588212061018448136404826965889433079453789166218230378522228564058127860367190611065605375025546257531489369344062782521806978218808940091447658298351853603237069980597505163602473095615670998464391197300372933147772009493823037167642459378452731092557170909406945309",";"}],"\n","\n",RowBox[
{"g"," ","="," ","79207621787760038235763239269746451281552097558625763440050213854787240633084667257397421010854631623596917364929357681934505810865796708268321894884518347711092708958596829555918931536779252059763083320084867242870421484137196365244257388686997557137455046446997809953054632950185678637137955632299024284915",";"}],"\n","\n",RowBox[
{"q"," ","="," ","1362115923099293242369922261305212343561846087883",";"}],"\n","\n",RowBox[
{"v"," ","="," ","{","\n","{","1",",","619311310785110344878836416273984416581430371173","}",",","\n","{","2",",","220907936619712576289434726289751713466433690475","}",",","\n","{","3",",","1062836239972148964746816039044821170613439031274","}",",","\n","{","4",",","219441170924868698090976713596648502000466097632","}",",","\n","{","5",",","769997620271316348268661610130177849902516927426","}",",","\n","{","6",",","1152146259925178602615911778263436461076216088723","}",",","\n","{","7",",","1265609569614709264377437123859554015401479253017","}",",","\n","{","8",",","27622757378293758883225993517808181889766051247","}",",","\n","{","9",",","352557220636434936138315231121552828463234787226","}",",","\n","{","10",",","337747710899905149402612844527914900307909406281","}",",","\n","{","11",",","408074998879030904571735053400025659341975961876","}",",","\n","{","12",",","271925584233507062825023990042341627755573905297","}",",","\n","{","13",",","167801178875722514699072578841732039412471552573","}",",","\n","{","14",",","1215985217388341923231119955575415137771382531343","}",",","\n","{","15",",","953825760487695828742611233289662182790112137666","}",",","\n","{","16",",","1355730400963642269517348283814918286334129481911","}",",","\n","{","17",",","333401019480769892705633319742082169586250859150","}",",","\n","{","18",",","1203077468869026709340437554152799314591570033572","}",",","\n","{","19",",","780727109454292810195069209027842666997521652229","}",",","\n","{","20",",","1046150562538251907293548132017414979380505628201","}",",","\n","{","21",",","137540952931199205035025678675407453219689668181","}",",","\n","{","22",",","404582379151007490997158361757365346779594113938","}",",","\n","{","23",",","378966561870353140758297219674667618272297723186","}",",","\n","{","24",",","1302080721716031913440954718326323707889087707305","}",",","\n","{","25",",","21383732861342750262278576498135557934860634013","}",",","\n","{","26",",","837349435393175658858854519035842875482791217528","}",",","\n","{","27",",","387690669841125991313215824325554482730756359167","}",",","\n","{","28",",","38204643061206400035502425414051442502304005458","}",",","\n","{","29",",","1163147193750001798494990269197994786865092309835","}",",","\n","{","30",",","227006724615367259463420309045775809389954735899","}",",","\n","{","31",",","415312498759421447833155432243818791427131791652","}",",","\n","{","32",",","1065267018829850103406482381315154805492264358817","}",",","\n","{","33",",","312783493757328994675220738991273345505657978779","}",",","\n","{","34",",","904101426589536308328483550336241764015271808421","}",",","\n","{","35",",","784035881088755861838308552429913042649613905446","}",",","\n","{","36",",","161738378962371249752519792335111527284660373254","}",",","\n","{","37",",","82622405487870656230621521611627429928992840768","}",",","\n","{","38",",","789206338064090433358712019015713432089276686868","}",",","\n","{","39",",","1126090955521442868122090730251179611488793008623","}",",","\n","{","40",",","1231575335419898007164594473633824093733945979701","}",",","\n","{","41",",","337704859324778486571336000534193002145885892188","}",",","\n","{","42",",","1333110826855772798831655381624938453720798352381","}",",","\n","{","43",",","1094051112250498436906997502312979629497393158642","}",",","\n","{","44",",","116626629967416990627018114590122150229812105815","}",",","\n","{","45",",","377971257253580712988443228271724695100653038531","}",",","\n","{","46",",","1020754016084196750680098008470324046091996330381","}",",","\n","{","47",",","349414629350310206757382318276615424979586313309","}",",","\n","{","48",",","76598924709693209680500013272368332993572154233","}",",","\n","{","49",",","1252521618647054895380153198934704783401647782359","}",",","\n","{","50",",","1201674969933940970283351338097354654958091069956","}",",","\n","{","51",",","25297449690893003469748793767556493697411597103","}",",","\n","{","52",",","425670255551623336724486542287515622767498638","}",",","\n","{","53",",","1306911037399802830023983074160668274350535500323","}",",","\n","{","54",",","779124934874316254121946305754552344403396888895","}",",","\n","{","55",",","1344574365033736944930311248551612503061959934065","}",",","\n","{","56",",","154495063999347647523077127486129791914555099005","}",",","\n","{","57",",","637291159618296833651597696183115742932265782519","}",",","\n","{","58",",","507084116717753924766776272389548257446683577087","}",",","\n","{","59",",","831697394661142166182872300303976742257815768744","}",",","\n","{","60",",","23754945027598079922756029505319405313617144683","}",",","\n","{","61",",","40842003081672431702707970215114303616998721313","}",",","\n","{","62",",","514280040084189517129003260247609701882069980995","}",",","\n","{","63",",","1135985081157043704171916675536752627455441510375","}",",","\n","{","64",",","400955350597445989152251486219420755185824390130","}",",","\n","{","65",",","1054274769811169260183268257031435033018066984678","}",",","\n","{","66",",","64043397893467523519722132317386585524283651761","}",",","\n","{","67",",","590482299346775940874933761309824046146404535475","}",",","\n","{","68",",","969288722183947115657554105540343607443692096161","}",",","\n","{","69",",","1157755835544066389144009956816048109161990120173","}",",","\n","{","70",",","488272965343449277525993572325819547674479029716","}",",","\n","{","71",",","701031680439465333551130221646004057211009171301","}",",","\n","{","72",",","176048712993089139661654091860803405067573335543","}",",","\n","{","73",",","577882891136138864144390410092514018151332145386","}",",","\n","{","74",",","1094902506542105624633915060711147103860718206005","}",",","\n","{","75",",","580311159973025216790072202489272157415397428927","}",",","\n","{","76",",","226607783123005932142560117126338957863066085481","}",",","\n","{","77",",","734572197655273227170157663563411651902311884180","}",",","\n","{","78",",","1043091941631684455312285060661596932478671960277","}",",","\n","{","79",",","221544661119506245503696478908123649257415907715","}",",","\n","{","80",",","354177094350287567569973044375337127090574828385","}",",","\n","{","81",",","681123187699367923345065330330044681663128852108","}",",","\n","{","82",",","1228190496818087340735459856432156534924860873333","}",",","\n","{","83",",","596716166083481789498912176517920716684140224757","}",",","\n","{","84",",","286126277565354435208245914446936510235372009212","}",",","\n","{","85",",","366824925194718918634502806285507589522386339271","}",",","\n","{","86",",","795840857358001794952091683056849469687452694963","}",",","\n","{","87",",","268400223386726016525781048398007057893608369349","}",",","\n","{","88",",","729105931493339328523501043936182151675967334359","}",",","\n","{","89",",","1288085485872587104959525039286337331149962541519","}",",","\n","{","90",",","793152779167035571188677859895368795279203633686","}",",","\n","{","91",",","744612026658181827099340487043202331770280242329","}",",","\n","{","92",",","203765542758168452635342607465861319817745092360","}",",","\n","{","93",",","842461441728320545413411318047230685823330717075","}",",","\n","{","94",",","148807713600781098963291673863222350265943105163","}",",","\n","{","95",",","246834982441351993547599867412027160896712354405","}",",","\n","{","96",",","291579337515635113684577330005940548576523780363","}",",","\n","{","97",",","1061269205353100875202829130674288389149403914658","}",",","\n","{","98",",","837799850325751966409358087175321854868764729126","}",",","\n","{","99",",","1146516475118855113364337611046387591886588987844","}",",","\n","{","100",",","157100854241329904498039779535083933046532132870","}","\n","}",";"}],"\n","\n",RowBox[
{"y"," ","="," ","{","\n","126530391122160243882257049226569794992681413839641973886815853418777524427346840988189336775520048535055660335916653527033466801404744527764022435095366980813089469199591791444923903751766781724121221937979137984931981271417836478173422910113068167662453637173576301475994906973251424044392150392797980347128",","," ","\n","32867759433586192513914305515590306162142544292132983988541773927936798392274846993593296521428079514686536978957177907856599488312856844462486532814134396353215541016440473055325841151398224426510787325138091265474633834041360796671066465748055527056953735932431699673528958073336296669270135729453925696018",","," ","\n","105115942465200668360549333101874161609575094562272089730550238106312614330876894157513648626903161020482368081216196484712673878081637270928991612719583111325020635912734845040625181104031707776102599923804100006555910579257718671909220796464258863895878762717290160897278106137311272128719326140856591423271",","," ","\n","96383070436814931095116442268552088781727536331624576136881100418647901702775941645994029071386649702221964723367776253163019750350362905050512154387552060969790150575149574036119443533056748585072832422880030942518779960700406036964854217986330168560726106141140575506111501217343915547441433823339075481214",","," ","\n","75034175298090703308600375957019436021523647531897632542091267272307763632035434279737818624587914060841982694310680809949854480459891222613962896676633778166643775460222122985216269891714498086473011248866994502608465796311323125971900372055664713902167738524182222397065716287308741677703547989306849165798",","," ","\n","27041760376909458721030394116763345426013861176686994835459709782398792481117587380358910949824657608702620423945434081986063775170682807554471686836115556461202037242046269850818812038559777568469249242770433955189024877599628973227071088454812833249591486352618329496433290543035935347454306547443724670800","\n","}",";"}],"\n","\n",RowBox[
{"i","=","1",";"}],"\n",RowBox[{"vk","=","{","}",";"}],"\n",RowBox[{"While","[","Length","[","vk","]","<","k",",","\n","If","[","ShamirVerifyShare","[","k",",","v","[","[","i","]","]",",","g",",","y",",","p","]",",","\n","AppendTo","[","vk",",","v","[","[","i","]","]","]","\n","]",";","\n","i","+=","1",";","\n","]",";"}],"\n",RowBox[
{"s","=","ShamirRestoreSec","[","k",",","q",",","vk","]",";"}],"\n","\n",RowBox[{"t","=","s",";"}],"\n",RowBox[
{"chars","=","{","}",";"}],"\n",RowBox[{"While","[","t",">","0",",","\n","char","=","Mod","[","t",",","2","^","8","]",";","\n","PrependTo","[","chars",",","char","]",";","\n","t","=","(","t","-","char",")","/","2","^","8","\n","]",";"}],"\n",RowBox[
{"FromCharacterCode","[","chars","]","\n","\n"}]}],"Input",CellID->78,CellLabel->"In[462]:= "],Cell[
BoxData[
"417479042958993742794699594486062112048871068462",StandardForm],"Output",CellID->244,
CellLabel->"Out[474]= "],Cell[
BoxData["\"I have mastered SSS.\"",StandardForm],"Output",
CellID->246,CellLabel->"Out[477]= "]},Open]],Cell[
CellGroupData[{Cell[
BoxData[{RowBox[
{"m","=","{","}",";"}],"\n",RowBox[{"For","[","i","=","0",",","i","\[LessEqual]","k","-","1",",","i","+=","1",",","\n","row","=","{","}",";","\n","For","[","j","=","1",",","j","\[LessEqual]","k",",","j","+=","1",",","\n","index","=","vk","[","[","j","]","]","[","[","1","]","]",";","\n","AppendTo","[","row",",","PowerMod","[","index",",","i",",","q","]","]",";","\n","]",";","\n","AppendTo","[","m",",","row","]",";","\n","]",";"}],"\n",RowBox[
{"vkvalues","=","{","}",";"}],"\n",RowBox[{"For","[","i","=","1",",","i","\[LessEqual]","k",",","i","+=","1",",","\n","AppendTo","[","vkvalues",",","vk","[","[","i","]","]","[","[","2","]","]","]",";","\n","]",";"}],"\n",RowBox[
{"m"}],"\n",RowBox[{"invm","=","ModMatInverse","[","m",",","q","]",";"}],"\n",RowBox[
{"ak","=","vkvalues",".","invm",";"}],"\n",RowBox[{"For","[","i","=","1",",","i","\[LessEqual]","Length","[","ak","]",",","i","+=","1",",","\n","Print","[","Mod","[","ak","[","[","i","]","]",",","q","]","]",";","\n","]",";","\n"}]}],
"Input",CellID->112,CellLabel->"In[614]:= "],Cell[
BoxData[RowBox[{"{",RowBox[{RowBox[
{"{",RowBox[{"1",",","1",",","1",",","1",",","1",",","1"}],"}"}],",",RowBox[{"{",RowBox[
{"14",",","15",",","33",",","54",",","88",",","92"}],"}"}],",",RowBox[{"{",RowBox[
{"196",",","225",",","1089",",","2916",",","7744",",","8464"}],"}"}],",",RowBox[{"{",RowBox[
{"2744",",","3375",",","35937",",","157464",",","681472",",","778688"}],"}"}],",",RowBox[
{"{",RowBox[{"38416",",","50625",",","1185921",",","8503056",",","59969536",",","71639296"}],"}"}],",",RowBox[
{"{",RowBox[{"537824",",","759375",",","39135393",",","459165024",",","5277319168",",","6590815232"}],"}"}]}],"}"}],
StandardForm],"Output",CellID->391,CellLabel->"Out[618]= "],Cell[
BoxData["417479042958993742794699594486062112048871068462",
StandardForm],"Print",CellID->393],Cell[
BoxData["1166460200462228630015643321872333410662936530274",
StandardForm],"Print",CellID->394],Cell[
BoxData["1219930995300421826187683945589564366785042776093",
StandardForm],"Print",CellID->395],Cell[
BoxData["834977034019669004245636849170244450890738847842",
StandardForm],"Print",CellID->396],Cell[
BoxData["1061981678307431226868415528464534660747903903589",
StandardForm],"Print",CellID->397],Cell[
BoxData["1292257347839082711003381745311230655255862069192",
StandardForm],"Print",CellID->398]},Open]]},StyleDefinitions->"Default.nb",FrontEndVersion->"10.0 for Wolfram Cloud Platform (June 2 2014)"]