(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41753,        940]
NotebookOptionsPosition[     40338,        894]
NotebookOutlinePosition[     40676,        909]
CellTagsIndexPosition[     40633,        906]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Load", "[", "\"\<./lib/RSAEnc.nb\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Load", "[", "\"\<./lib/RSADec.nb\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Load", "[", "\"\<./lib/Inv.nb\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Load", "[", "\"\<./problem/RSAOAEP_data.m\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Load", "[", "\"\<./160701_mathematica_functions/MGF.m\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Load", "[", "\"\<./160701_mathematica_functions/RandomSeccap2_linux.m\>\"",
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6774623004314137`*^9, 3.67746230113186*^9}, {
   3.677462442473659*^9, 3.6774624462757063`*^9}, {3.6774625321744432`*^9, 
   3.677462533338914*^9}, {3.677462563569602*^9, 3.677462564107521*^9}, {
   3.6774626083289623`*^9, 3.67746264808433*^9}, {3.677463255761484*^9, 
   3.6774632567111273`*^9}, 3.677471823586504*^9, {3.677475171813932*^9, 
   3.677475196005048*^9}, {3.6774769994397793`*^9, 3.677477000324774*^9}, 
   3.677477030581809*^9, {3.677477060629025*^9, 3.6774771212974052`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.677544446447033*^9, 3.677544447241314*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.677475221291201*^9, 3.677475221883565*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.677462718017651*^9, {3.677462770434078*^9, 3.677462819933134*^9}, {
   3.677462887759818*^9, 3.677462939632411*^9}, {3.677462969871662*^9, 
   3.677462970329657*^9}, {3.677463011846121*^9, 3.677463038297274*^9}, {
   3.677469635281136*^9, 3.677469640635062*^9}, 3.677471840147273*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "MGF1", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MGF1", "[", 
      RowBox[{"mgfSeed_", ",", "maskLen_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hLen", ",", "T", ",", "counter", ",", "C"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hLen", "=", "40"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "length", " ", "of", " ", "SHA1", " ", "hash", " ", "is", " ", 
          "40"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"maskLen", ">", 
           RowBox[{
            RowBox[{"2", "^", "32"}], " ", "*", " ", "hLen"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<mask too long\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"T", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"counter", "=", "0"}], ",", 
          RowBox[{"counter", "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"maskLen", "/", "hLen"}], ")"}], "-", "1"}]}], ",", 
          RowBox[{"counter", "+=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"C", "=", 
            RowBox[{"I2OSP", "[", 
             RowBox[{"counter", ",", "4"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"T", "=", 
            RowBox[{"T", "<>", 
             RowBox[{"IntegerString", "[", 
              RowBox[{
               RowBox[{"Hash", "[", 
                RowBox[{
                 RowBox[{"mgfSeed", "<>", "C"}], ",", "\"\<SHA\>\""}], "]"}], 
               ",", "16"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "T", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Integer", "-", "to", "-", "Octet", "-", 
     RowBox[{"String", " ", "primitive"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "I2OSP", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"I2OSP", "[", 
      RowBox[{"x_", ",", "xLen_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", ">=", 
           RowBox[{"256", "^", "xLen"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<mask too long\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"x", ",", "16", ",", 
           RowBox[{"xLen", "*", "2"}]}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "XorHexString", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"XorHexString", "[", 
      RowBox[{"a_", ",", " ", "b_", ",", "len_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"BitXor", "[", 
            RowBox[{
             RowBox[{"FromDigits", "[", 
              RowBox[{"a", ",", "16"}], "]"}], ",", 
             RowBox[{"FromDigits", "[", 
              RowBox[{"b", ",", "16"}], "]"}]}], "]"}], ",", "16", ",", 
           RowBox[{"len", "*", "2"}]}], "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.677463260626087*^9, {3.6774634135309677`*^9, 3.677463414804253*^9}, {
   3.677464246233407*^9, 3.677464246784502*^9}, {3.677464861304516*^9, 
   3.677464934840416*^9}, {3.677464965075137*^9, 3.677464993285757*^9}, {
   3.677465023599937*^9, 3.677465023932873*^9}, {3.677465121138207*^9, 
   3.67746518276927*^9}, 3.67746534412245*^9, {3.677465393480138*^9, 
   3.677465542330112*^9}, {3.6774658246954813`*^9, 3.6774658298473263`*^9}, {
   3.677465955852385*^9, 3.677466060124988*^9}, {3.677466261326912*^9, 
   3.677466262427435*^9}, {3.677466671242873*^9, 3.677466673160874*^9}, {
   3.677466703512607*^9, 3.677466879494698*^9}, {3.677467226171249*^9, 
   3.677467251634235*^9}, {3.6774672978424997`*^9, 3.6774673017330723`*^9}, {
   3.677467429917004*^9, 3.677467431827856*^9}, {3.677467492164226*^9, 
   3.677467492215762*^9}, {3.677467570227735*^9, 3.677467572057109*^9}, {
   3.677467632406941*^9, 3.677467632460919*^9}, {3.677467731793703*^9, 
   3.677467776612952*^9}, {3.677470359361845*^9, 3.677470359774032*^9}, {
   3.6774704405660887`*^9, 3.677470441381103*^9}, {3.677544607327718*^9, 
   3.677544656455717*^9}, {3.677545179976302*^9, 3.6775451892713413`*^9}, {
   3.677545274528696*^9, 3.677545277098991*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RandomSeccap2", "[", 
    RowBox[{"20", ",", "\"\<crypt\>\"", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<r=\>\"", ",", "r"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"e", " ", "=", " ", "130621"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "m", " ", "=", " ", 
    "\"\<e69c80e696b0e68385e5a0b1e382bbe382ade383a5e383aae38386e382a3e79086e8a\
b96\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
  "p", " ", "=", " ", 
   "\"\<bb65b197c48f6b16e70bade44937ae8b5a1a81824f435cb09d7d97a121535a3d29626e\
2568eea0e30a4d6f1e2f66283c732c47da6b6ba90f8ee9b197570f3847\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "q", " ", "=", " ", 
    "\"\<8604c4009242012a6e4650c7d5bae2ea6dc2bfd2627cc96cb0196c514fde2161d12de\
9f90ea5d0c1b41fee6cac90fe6ee7138c111c554372044b90ae89873ebd\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Crypt", " ", "=", " ", 
    "\"\<25b48cf971e880ba2f3455f1c74a227b23a0a37b0bd1a4539a935d56ccebfda276c25\
2bb1688c774eaad9618d0e42236b72bdca75a387a848cff4e24439d5afea188e2212ee69283844\
1af8c7b06ec4d3f6f943f7bbc4917805152fe2c16dd7afa16a9745dab68e7187b1b38e717bad09\
1606ec33a8f13d73a216028e54fc39d\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"pnum", "=", 
   RowBox[{"FromDigits", "[", 
    RowBox[{"p", ",", "16"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qnum", "=", 
   RowBox[{"FromDigits", "[", 
    RowBox[{"q", ",", "16"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nnum", " ", "=", " ", 
   RowBox[{"pnum", "*", "qnum"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"IntegerString", "[", 
    RowBox[{"nnum", ",", " ", "16"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<n=\>\"", ",", "n"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", 
    RowBox[{"StringLength", "[", "n", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "k", " ", "denotes", " ", "the", " ", "length", " ", "in", " ", "octets", 
    " ", "of", " ", "the", " ", "RSA", " ", "modulus", " ", "n"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seed", "=", "r"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hLen", "=", "40"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "length", " ", "of", " ", "SHA1", " ", "hash", " ", "is", " ", "40"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mLen", "=", 
   RowBox[{"StringLength", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lHash", "=", "\"\<da39a3ee5e6b4b0d3255bfef95601890afd80709\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PS", "=", 
   RowBox[{"IntegerString", "[", 
    RowBox[{"0", ",", "16", ",", 
     RowBox[{"k", "-", "mLen", "-", 
      RowBox[{"2", "*", "hLen"}], "-", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DB", "=", 
   RowBox[{"lHash", "<>", "PS", "<>", "\"\<01\>\"", "<>", "m"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dbMask", "=", 
   RowBox[{"MGF", "[", 
    RowBox[{"seed", ",", 
     RowBox[{
      RowBox[{"StringLength", "[", "DB", "]"}], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maskedDB", "=", 
   RowBox[{"XorHexString", "[", 
    RowBox[{"DB", ",", " ", "dbMask", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", "-", "hLen", "-", "2"}], ")"}], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<s=\>\"", ",", "maskedDB"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seedMask", "=", 
   RowBox[{"MGF", "[", 
    RowBox[{"maskedDB", ",", 
     RowBox[{"hLen", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maskedSeed", "=", 
   RowBox[{"XorHexString", "[", 
    RowBox[{"seed", ",", "seedMask", ",", 
     RowBox[{"hLen", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<t=\>\"", ",", "maskedSeed"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EM", "=", 
   RowBox[{"\"\<00\>\"", "<>", "maskedSeed", "<>", "maskedDB"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<w=\>\"", ",", "EM"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"RSAEnc", "[", 
    RowBox[{
     RowBox[{"FromDigits", "[", 
      RowBox[{"EM", ",", "16"}], "]"}], ",", "nnum", ",", "e"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<c=\>\"", ",", 
    RowBox[{"IntegerString", "[", 
     RowBox[{"c", ",", "16"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6774669174063263`*^9, 3.677466933501526*^9}, {
   3.677466985186286*^9, 3.67746698543045*^9}, {3.677467133847571*^9, 
   3.677467149640642*^9}, {3.67746718410386*^9, 3.6774671915972433`*^9}, {
   3.677467259627569*^9, 3.677467269276807*^9}, {3.6774673991273108`*^9, 
   3.677467400002297*^9}, {3.677467552255484*^9, 3.6774675523788767`*^9}, {
   3.677467638680657*^9, 3.677467638846795*^9}, {3.677467836666068*^9, 
   3.6774678968287783`*^9}, {3.6774679270620117`*^9, 3.67746799220531*^9}, {
   3.67746818487696*^9, 3.677468253239602*^9}, {3.677468346992634*^9, 
   3.677468362461993*^9}, {3.677468859568427*^9, 3.677468868270852*^9}, {
   3.677468984421548*^9, 3.677468989783894*^9}, {3.677469105813261*^9, 
   3.677469149798841*^9}, {3.677469231552906*^9, 3.6774692469997587`*^9}, {
   3.677469355323443*^9, 3.677469403104323*^9}, {3.6774694412326307`*^9, 
   3.6774694421264067`*^9}, {3.677469472366153*^9, 3.6774694967651787`*^9}, {
   3.677469533112339*^9, 3.677469570075388*^9}, {3.677469648286811*^9, 
   3.677469668312688*^9}, 3.6774696984830008`*^9, {3.6774697586213293`*^9, 
   3.677469764885746*^9}, {3.677469943978291*^9, 3.677469952343596*^9}, {
   3.677470030032525*^9, 3.6774700500822153`*^9}, {3.677470124832343*^9, 
   3.677470149929139*^9}, {3.6774702279952507`*^9, 3.677470243894184*^9}, {
   3.677470293742776*^9, 3.677470352520461*^9}, {3.677470400913994*^9, 
   3.677470452717085*^9}, {3.677470497276945*^9, 3.67747054422084*^9}, {
   3.677470585550535*^9, 3.677470886335556*^9}, {3.677471089774522*^9, 
   3.677471137363639*^9}, {3.677471267253456*^9, 3.677471275062542*^9}, {
   3.677471305134411*^9, 3.677471352290247*^9}, {3.677471459726946*^9, 
   3.6774715282306557`*^9}, {3.677471826748486*^9, 3.6774718786157703`*^9}, {
   3.677471918890894*^9, 3.677471920225751*^9}, {3.6774736234898033`*^9, 
   3.677473634000091*^9}, {3.677473894223996*^9, 3.677473895688135*^9}, {
   3.6774741833169394`*^9, 3.677474212544951*^9}, 3.677475349365302*^9, {
   3.677475660665382*^9, 3.677475685302845*^9}, {3.677476748473938*^9, 
   3.677476846896702*^9}, {3.6774771681067047`*^9, 3.67747722077032*^9}, {
   3.6774779175805197`*^9, 3.677477940699924*^9}, {3.677478118716084*^9, 
   3.6774781188694487`*^9}, {3.677478155242674*^9, 3.677478183174508*^9}, {
   3.6775444773943644`*^9, 3.677544502723328*^9}, {3.677544668086426*^9, 
   3.677544697052545*^9}, {3.6775449198258667`*^9, 3.677544946458971*^9}, {
   3.677545166476994*^9, 3.6775451699068003`*^9}, {3.677545207279868*^9, 
   3.6775452805366287`*^9}, {3.677546527442842*^9, 3.677546555024695*^9}, {
   3.6775466360727797`*^9, 3.677546636284326*^9}, {3.6775466708934813`*^9, 
   3.67754667155581*^9}, {3.677546908989822*^9, 3.6775469363116827`*^9}, {
   3.677546969663571*^9, 3.6775469827801933`*^9}, {3.67754707944118*^9, 
   3.67754709419267*^9}, {3.6775471585420732`*^9, 3.6775471802752943`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"n=\"\>", 
   "\[InvisibleSpace]", \
"\<\"621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a95265b4d\
a33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138fcf4\
79f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18c333\
7d30ba03b2a14be0237a24ebe6b\"\>"}],
  SequenceForm[
  "n=", "621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a9526\
5b4da33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138\
fcf479f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18\
c3337d30ba03b2a14be0237a24ebe6b"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6775471750816593`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"s=\"\>", 
   "\[InvisibleSpace]", \
"\<\"464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b7782\
73d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf602bf\
b3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "s=", "464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b\
778273d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf6\
02bfb3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547175105316*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", 
   "\[InvisibleSpace]", "\<\"274ce637acffcb9a8fa397c77c55a0cd8d10eeca\"\>"}],
  SequenceForm["t=", "274ce637acffcb9a8fa397c77c55a0cd8d10eeca"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547175129224*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"w=\"\>", 
   "\[InvisibleSpace]", \
"\<\"00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7764e\
5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580cb7c\
99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f32606044\
26a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "w=", "00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7\
764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580\
cb7c99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f3260\
604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547175130293*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"c=\"\>", 
   "\[InvisibleSpace]", \
"\<\"1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01bde0\
3a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5e73f\
7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019ea50\
97954d56d8f77ccfff7c47ac112\"\>"}],
  SequenceForm[
  "c=", "1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01\
bde03a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5\
e73f7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019\
ea5097954d56d8f77ccfff7c47ac112"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547175131452*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r=\"\>", 
   "\[InvisibleSpace]", "\<\"E0E2E7F91C11743E84771EE06A69235564933285\"\>"}],
  SequenceForm["r=", "E0E2E7F91C11743E84771EE06A69235564933285"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.677547180793994*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"n=\"\>", 
   "\[InvisibleSpace]", \
"\<\"621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a95265b4d\
a33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138fcf4\
79f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18c333\
7d30ba03b2a14be0237a24ebe6b\"\>"}],
  SequenceForm[
  "n=", "621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a9526\
5b4da33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138\
fcf479f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18\
c3337d30ba03b2a14be0237a24ebe6b"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.677547180814062*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"s=\"\>", 
   "\[InvisibleSpace]", \
"\<\"464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b7782\
73d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf602bf\
b3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "s=", "464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b\
778273d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf6\
02bfb3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.6775471808374777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", 
   "\[InvisibleSpace]", "\<\"274ce637acffcb9a8fa397c77c55a0cd8d10eeca\"\>"}],
  SequenceForm["t=", "274ce637acffcb9a8fa397c77c55a0cd8d10eeca"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.6775471808382187`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"w=\"\>", 
   "\[InvisibleSpace]", \
"\<\"00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7764e\
5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580cb7c\
99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f32606044\
26a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "w=", "00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7\
764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580\
cb7c99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f3260\
604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.677547180839006*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"c=\"\>", 
   "\[InvisibleSpace]", \
"\<\"1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01bde0\
3a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5e73f\
7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019ea50\
97954d56d8f77ccfff7c47ac112\"\>"}],
  SequenceForm[
  "c=", "1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01\
bde03a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5\
e73f7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019\
ea5097954d56d8f77ccfff7c47ac112"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949094*^9, 3.677547180839821*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r=\"\>", 
   "\[InvisibleSpace]", "\<\"E0E2E7F91C11743E84771EE06A69235564933285\"\>"}],
  SequenceForm["r=", "E0E2E7F91C11743E84771EE06A69235564933285"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6775471893293943`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"n=\"\>", 
   "\[InvisibleSpace]", \
"\<\"621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a95265b4d\
a33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138fcf4\
79f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18c333\
7d30ba03b2a14be0237a24ebe6b\"\>"}],
  SequenceForm[
  "n=", "621ab8067e4aa724439da010779c3985b491f066585827eb71b90263d3ed7272a9526\
5b4da33815251ffb81f9c7893a3f2b68bf3c0d961320ba59138dc35091c457bba9ce6f7b7cf138\
fcf479f7534db98df6b1f23bdb6508a5f15c4d34c68e17c2b25bf72223f8b36080744b49760d18\
c3337d30ba03b2a14be0237a24ebe6b"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6775471893512506`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"s=\"\>", 
   "\[InvisibleSpace]", \
"\<\"464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b7782\
73d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf602bf\
b3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "s=", "464e09fb6d878a5f2324c3944e7764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b\
778273d0fc9776debb5e762ca11ebd375580cb7c99a0539baa76357893ee8644caf148e13dedf6\
02bfb3659108b670134a42a548f9b34f3260604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6775471893622427`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", 
   "\[InvisibleSpace]", "\<\"274ce637acffcb9a8fa397c77c55a0cd8d10eeca\"\>"}],
  SequenceForm["t=", "274ce637acffcb9a8fa397c77c55a0cd8d10eeca"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547189363061*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"w=\"\>", 
   "\[InvisibleSpace]", \
"\<\"00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7764e\
5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580cb7c\
99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f32606044\
26a2a37c81ba32c98b7d65b465f\"\>"}],
  SequenceForm[
  "w=", "00274ce637acffcb9a8fa397c77c55a0cd8d10eeca464e09fb6d878a5f2324c3944e7\
764e5e810a2a3a2c92b3513b6cc5b6158a1cad614b778273d0fc9776debb5e762ca11ebd375580\
cb7c99a0539baa76357893ee8644caf148e13dedf602bfb3659108b670134a42a548f9b34f3260\
604426a2a37c81ba32c98b7d65b465f"],
  Editable->False]], "Print",
 CellChangeTimes->{3.677547189363797*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"c=\"\>", "\[InvisibleSpace]", 
   "\"\<1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01b\
de03a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5e\
73f7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019e\
a5097954d56d8f77ccfff7c47ac112\>\""}],
  SequenceForm[
  "c=", "1ad7f45aacd664d3775d58d58727167d7e715391f7ca76bbeb94dd4125b03adcc8a01\
bde03a8b39c03f5925cf7d2b31d28daae5d51dc17599262258295d2e210f959ef4081188610fc5\
e73f7291f5708057d7fddd4967163b7a93bd421ce6c2529c7e034d41ab53bfae4c122419f05019\
ea5097954d56d8f77ccfff7c47ac112"],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.677547189364469*^9, 3.677547288955185*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"c=\"\>", 
   "\[InvisibleSpace]", \
"\<\"2abdb5118bbc47169780023a56fb453bb06d2284513adb8761ab8a61dc9c3afc8dc8ff3b0\
ca02f1eed07970f518cda45663585598688cb2fc1530d6fcd3a1812524f3081b851ef059779dc7\
6ffca21a63260e7247f3300abd483e6418ab22b54fdea3fe0ffdef005ce9e009f024c10940a77f\
7b044415ec34bea38ba06bc29a3\"\>"}],
  SequenceForm[
  "c=", "2abdb5118bbc47169780023a56fb453bb06d2284513adb8761ab8a61dc9c3afc8dc8f\
f3b0ca02f1eed07970f518cda45663585598688cb2fc1530d6fcd3a1812524f3081b851ef05977\
9dc76ffca21a63260e7247f3300abd483e6418ab22b54fdea3fe0ffdef005ce9e009f024c10940\
a77f7b044415ec34bea38ba06bc29a3"],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.6774708868831377`*^9, 3.677471137749363*^9, 3.677471354142199*^9, {
   3.677471465593042*^9, 3.677471479673869*^9}, 3.677471528650779*^9, 
   3.677471868046639*^9, {3.677474191306527*^9, 3.677474216748914*^9}, 
   3.6774751393157063`*^9, 3.67747525409794*^9, 3.677475353683446*^9, {
   3.6774767749411488`*^9, 3.677476847295982*^9}, {3.677477210834639*^9, 
   3.677477221316132*^9}, {3.6774779351291533`*^9, 3.6774779416625957`*^9}, 
   3.677478006242063*^9, 3.6774781236772203`*^9, 3.677478189509383*^9, 
   3.6775445077991257`*^9, 3.677544943546474*^9, 3.677544996018087*^9, {
   3.6775450879125566`*^9, 3.677545117831802*^9}, {3.677545259485631*^9, 
   3.677545280867845*^9}, {3.6775465488248997`*^9, 3.677546555891777*^9}, 
   3.6775466368148212`*^9, 3.6775466720849333`*^9, {3.677546910962879*^9, 
   3.6775469376682243`*^9}, 3.677546983407608*^9, 3.6775470281882277`*^9, 
   3.6775470949523582`*^9, 3.677547139739028*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", "decrypt", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mLen", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K", "=", 
     RowBox[{"Inv", "[", 
      RowBox[{"e", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pnum", "-", "1"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"qnum", "-", "1"}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"FromDigits", "[", 
      RowBox[{"Crypt", ",", "16"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EMint", "=", 
     RowBox[{"RSADec", "[", 
      RowBox[{"c", ",", 
       RowBox[{"Mod", "[", 
        RowBox[{"K", ",", 
         RowBox[{"pnum", "-", "1"}]}], "]"}], ",", 
       RowBox[{"Mod", "[", 
        RowBox[{"K", ",", 
         RowBox[{"qnum", "-", "1"}]}], "]"}], ",", "pnum", ",", "qnum", ",", 
       RowBox[{"Inv", "[", 
        RowBox[{"qnum", ",", "pnum"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{"BitShiftRight", "[", 
      RowBox[{"EMint", ",", 
       RowBox[{"8", "*", "127"}]}], "]"}]}], ";", 
    RowBox[{"(*", "w\:306e\:6700\:4e0a\:4f4d\:30d0\:30a4\:30c8", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"tmp", "\[NotEqual]", "0"}], ",", 
      RowBox[{
       RowBox[{
       "Print", "[", "\"\<Error:\:5fa9\:53f7\:30a8\:30e9\:30fc\>\"", "]"}], 
       ";", 
       RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{"BitShiftRight", "[", 
      RowBox[{"EMint", ",", 
       RowBox[{"8", "*", "107"}]}], "]"}]}], ";", 
    RowBox[{"(*", "t\:3092\:62bd\:51fa", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"maskedSeed", "=", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"tmp", ",", "16", ",", "40"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmp", "=", 
     RowBox[{"BitAnd", "[", 
      RowBox[{"EMint", ",", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"107", "*", "8"}], ")"}]}], "-", "1"}]}], "]"}]}], ";", 
    RowBox[{"(*", "s\:3092\:62bd\:51fa", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"maskedDB", "=", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"tmp", ",", "16"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"seedMask", "=", 
     RowBox[{"MGF", "[", 
      RowBox[{"maskedDB", ",", "20"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"H", 
      RowBox[{"(", "s", ")"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"r", "=", 
     RowBox[{"XorHexString", "[", 
      RowBox[{"maskedSeed", ",", "seedMask", ",", 
       RowBox[{"hLen", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dbMask", "=", 
     RowBox[{"MGF", "[", 
      RowBox[{"r", ",", "107"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"G", 
      RowBox[{"(", "r", ")"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"DB", "=", 
     RowBox[{"XorHexString", "[", 
      RowBox[{"maskedDB", ",", "dbMask", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"k", "-", "hLen", "-", "2"}], ")"}], "/", "2"}]}], "]"}]}], 
    ";", 
    RowBox[{"(*", "z", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"IHash", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"DB", ",", "40"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PSx01", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"DB", ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", 
         RowBox[{"214", "-", 
          RowBox[{"2", "*", "mLen"}]}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"PS", "||", 
      RowBox[{"0", "x01"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"m", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"DB", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "*", "mLen"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "m", "\[IndentingNewLine]", 
   RowBox[{"FromDigits", "[", 
    RowBox[{"PSx01", ",", "16"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.677473898973835*^9, 3.67747393534204*^9}, {
   3.67747396565212*^9, 3.67747400700709*^9}, {3.677474141943804*^9, 
   3.677474156100593*^9}, {3.677474221589525*^9, 3.677474232505155*^9}, {
   3.67747437718215*^9, 3.677474416373968*^9}, {3.677474449982873*^9, 
   3.6774744646711683`*^9}, {3.677474512546157*^9, 3.6774745319338303`*^9}, {
   3.6774745714274397`*^9, 3.677474618730451*^9}, {3.6774746779460917`*^9, 
   3.6774747065335073`*^9}, {3.677477366817884*^9, 3.6774773968501883`*^9}, {
   3.677477496010579*^9, 3.677477574524979*^9}, {3.677477672586617*^9, 
   3.67747777599914*^9}, {3.677477808397867*^9, 3.6774778344736557`*^9}, {
   3.677477867357897*^9, 3.677477898820547*^9}, {3.677477953702718*^9, 
   3.6774779999104223`*^9}, {3.677545011240397*^9, 3.6775450143841743`*^9}, {
   3.677545047181048*^9, 3.677545068708049*^9}, {3.6775453465883837`*^9, 
   3.6775454346807623`*^9}, {3.677545508429483*^9, 3.677545517597767*^9}, {
   3.677545707718498*^9, 3.677545708040147*^9}, {3.677545757283815*^9, 
   3.677545757575921*^9}, {3.677545791463509*^9, 3.677545792605637*^9}, 
   3.677545831333952*^9, {3.6775459147267237`*^9, 3.677545933411942*^9}, {
   3.6775460969207973`*^9, 3.67754612228441*^9}, {3.677546161333377*^9, 
   3.677546222527022*^9}, {3.67754633691812*^9, 3.677546357360145*^9}, {
   3.677546409861397*^9, 3.677546472238715*^9}, {3.677546562036275*^9, 
   3.67754657528469*^9}}],

Cell[BoxData["\<\"20110505\"\>"], "Output",
 CellChangeTimes->{{3.6774775503889112`*^9, 3.677477574975832*^9}, {
   3.67747767638344*^9, 3.6774777114548283`*^9}, 3.677477770300953*^9, 
   3.677477830137863*^9, {3.677477868908543*^9, 3.677477899117085*^9}, {
   3.67747797135697*^9, 3.6774779848042517`*^9}, 3.677478082523295*^9, 
   3.677544911969245*^9, 3.677545069471566*^9, {3.677545367373959*^9, 
   3.677545435131027*^9}, 3.677545518126767*^9, 3.67754570847353*^9, 
   3.677545760664968*^9, {3.677545809168333*^9, 3.6775458320583982`*^9}, {
   3.6775459176550417`*^9, 3.6775459340005302`*^9}, {3.677546428960096*^9, 
   3.6775464728015842`*^9}, 3.6775465638977423`*^9, 3.677547018823669*^9, 
   3.677547141315769*^9, 3.677547269240484*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6774775503889112`*^9, 3.677477574975832*^9}, {
   3.67747767638344*^9, 3.6774777114548283`*^9}, 3.677477770300953*^9, 
   3.677477830137863*^9, {3.677477868908543*^9, 3.677477899117085*^9}, {
   3.67747797135697*^9, 3.6774779848042517`*^9}, 3.677478082523295*^9, 
   3.677544911969245*^9, 3.677545069471566*^9, {3.677545367373959*^9, 
   3.677545435131027*^9}, 3.677545518126767*^9, 3.67754570847353*^9, 
   3.677545760664968*^9, {3.677545809168333*^9, 3.6775458320583982`*^9}, {
   3.6775459176550417`*^9, 3.6775459340005302`*^9}, {3.677546428960096*^9, 
   3.6775464728015842`*^9}, 3.6775465638977423`*^9, 3.677547018823669*^9, 
   3.677547141315769*^9, 3.6775472692420683`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6774756883790092`*^9, 3.6774757107509937`*^9}, {
  3.677475754311871*^9, 3.677475818292107*^9}, {3.677476172894671*^9, 
  3.677476220957152*^9}, {3.677476270229249*^9, 3.6774764141022873`*^9}, {
  3.67747644935457*^9, 3.677476482814528*^9}, {3.677476513050682*^9, 
  3.677476513493351*^9}, {3.677476543634736*^9, 3.677476608658958*^9}, {
  3.6774766655786057`*^9, 3.677476700172648*^9}, {3.6774772351406593`*^9, 
  3.677477238007945*^9}}]
},
WindowSize->{1054, 990},
WindowMargins->{{Automatic, 173}, {Automatic, 0}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 16, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1189, 26, 143, "Input"],
Cell[1750, 48, 92, 1, 32, "Input"],
Cell[1845, 51, 92, 1, 32, "Input"],
Cell[1940, 54, 335, 5, 32, "Input"],
Cell[2278, 61, 5408, 124, 693, "Input"],
Cell[CellGroupData[{
Cell[7711, 189, 7841, 186, 913, "Input"],
Cell[CellGroupData[{
Cell[15577, 379, 725, 14, 81, "Print"],
Cell[16305, 395, 635, 12, 62, "Print"],
Cell[16943, 409, 274, 6, 23, "Print"],
Cell[17220, 417, 723, 14, 81, "Print"],
Cell[17946, 433, 723, 14, 81, "Print"],
Cell[18672, 449, 1180, 19, 23, "Print"],
Cell[19855, 470, 1629, 27, 81, "Print"],
Cell[21487, 499, 1543, 25, 62, "Print"],
Cell[23033, 526, 1182, 19, 23, "Print"],
Cell[24218, 547, 1629, 27, 81, "Print"],
Cell[25850, 576, 1629, 27, 81, "Print"],
Cell[27482, 605, 276, 6, 23, "Print"],
Cell[27761, 613, 725, 14, 81, "Print"],
Cell[28489, 629, 637, 12, 62, "Print"],
Cell[29129, 643, 274, 6, 23, "Print"],
Cell[29406, 651, 723, 14, 81, "Print"],
Cell[30132, 667, 793, 15, 81, "Print"],
Cell[30928, 684, 1683, 29, 81, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32660, 719, 5691, 139, 561, "Input"],
Cell[38354, 860, 744, 10, 32, "Output"],
Cell[39101, 872, 731, 10, 32, "Output"]
}, Open  ]],
Cell[39847, 885, 487, 7, 32, "Input"]
}
]
*)

(* End of internal cache information *)
